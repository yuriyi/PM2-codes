(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    221664,       4985]
NotebookOptionsPosition[    207272,       4768]
NotebookOutlinePosition[    207615,       4783]
CellTagsIndexPosition[    207572,       4780]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Functions for modeling", "Section",
 CellChangeTimes->{{3.747377317072413*^9, 
  3.7473773300932627`*^9}},ExpressionUUID->"4252a514-f584-47d0-aff6-\
7b89297f0eb3"],

Cell[CellGroupData[{

Cell["Linear-solid stiffness matrix", "Subsection",
 CellChangeTimes->{{3.747376755757457*^9, 3.747376825838875*^9}, 
   3.747463822529325*^9},ExpressionUUID->"7db7c486-ac47-4517-b555-\
2e9483f292a6"],

Cell["cij0[i], Q0[i] are assumed defined for each layer i", "CodeText",
 CellChangeTimes->{{3.7471221099131403`*^9, 3.747122156274124*^9}, {
   3.747122254137911*^9, 3.747122268201149*^9}, {3.7471222993510733`*^9, 
   3.747122314654456*^9}, {3.747122352668804*^9, 3.747122354116933*^9}, {
   3.747122387497159*^9, 3.747122784093178*^9}, {3.747123005174747*^9, 
   3.747123064142342*^9}, {3.747123150023451*^9, 3.747123218397501*^9}, {
   3.747215567380432*^9, 3.747215652626376*^9}, {3.747215742214069*^9, 
   3.747215788891487*^9}, 3.747296533378478*^9, {3.747312241642372*^9, 
   3.747312242535344*^9}, {3.747376736037942*^9, 3.747376740290017*^9}, {
   3.747376796237442*^9, 3.747376796377987*^9}, {3.747376846066617*^9, 
   3.7473768916112967`*^9}, {3.747376957364555*^9, 
   3.747376978890777*^9}},ExpressionUUID->"694d0844-6d58-4b0e-8566-\
d121be6088e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cijCarcione", "[", 
   RowBox[{"pars_", ",", "f0_", ",", "\[Omega]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "c11i", ",", "c13i", ",", "c33i", ",", "c44i", ",", "\[Rho]i", ",", 
      "Q01i", ",", "Q02i"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c11i", ",", "c13i", ",", "c33i", ",", "c44i", ",", "\[Rho]i", ",", 
        "Q01i", ",", "Q02i"}], "}"}], "=", "pars"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["c33i", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["Q01i", "2"]}]], "+", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q01i"}],
             "\[Omega]"]}]], "+", 
         FractionBox[
          RowBox[{"c11i", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
              "Q01i"}], "+", 
             RowBox[{
              SqrtBox[
               RowBox[{"1", "+", 
                SuperscriptBox["Q01i", "2"]}]], " ", "\[Omega]"}]}], ")"}]}], 
          RowBox[{
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q01i"}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SqrtBox[
               RowBox[{"1", "+", 
                SuperscriptBox["Q01i", "2"]}]]}], ")"}], " ", "\[Omega]"}]}]],
          "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", "c44i", " ", "\[Omega]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               RowBox[{"(", 
                RowBox[{"Q01i", "-", "Q02i"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q01i", "2"]}]], "-", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q02i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               "Q01i"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q01i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               "Q02i"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q02i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}]}], ")"}]}]}], ",", 
        RowBox[{"c13i", "+", 
         FractionBox["c11i", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["Q01i", "2"]}]], "+", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q01i"}],
             "\[Omega]"]}]], "+", 
         FractionBox["c33i", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["Q01i", "2"]}]], "+", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q01i"}],
             "\[Omega]"]}]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", "c44i", " ", "\[Omega]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               RowBox[{"(", 
                RowBox[{"Q01i", "+", "Q02i"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q01i", "2"]}]], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q02i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               "Q01i"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q01i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               "Q02i"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q02i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}]}], ")"}]}]}], ",", 
        RowBox[{
         FractionBox["c11i", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["Q01i", "2"]}]], "+", 
           FractionBox[
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q01i"}],
             "\[Omega]"]}]], "+", 
         FractionBox[
          RowBox[{"c33i", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
              "Q01i"}], "+", 
             RowBox[{
              SqrtBox[
               RowBox[{"1", "+", 
                SuperscriptBox["Q01i", "2"]}]], " ", "\[Omega]"}]}], ")"}]}], 
          RowBox[{
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q01i"}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SqrtBox[
               RowBox[{"1", "+", 
                SuperscriptBox["Q01i", "2"]}]]}], ")"}], " ", "\[Omega]"}]}]],
          "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", "c44i", " ", "\[Omega]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               RowBox[{"(", 
                RowBox[{"Q01i", "-", "Q02i"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q01i", "2"]}]], "-", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q02i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               "Q01i"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q01i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", 
               "Q02i"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["Q02i", "2"]}]]}], ")"}], " ", 
               "\[Omega]"}]}], ")"}]}], ")"}]}]}], ",", 
        FractionBox[
         RowBox[{"c44i", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q02i"}],
             "+", "\[Omega]", "+", 
            RowBox[{
             SqrtBox[
              RowBox[{"1", "+", 
               SuperscriptBox["Q02i", "2"]}]], " ", "\[Omega]"}]}], ")"}]}], 
         RowBox[{
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "f0", " ", "\[Pi]", " ", "Q02i"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SqrtBox[
              RowBox[{"1", "+", 
               SuperscriptBox["Q02i", "2"]}]]}], ")"}], " ", "\[Omega]"}]}]], 
        ",", "\[Rho]i"}], "}"}], "//", "N"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7471221099131403`*^9, 3.747122156274124*^9}, {
   3.747122254137911*^9, 3.747122268201149*^9}, {3.7471222993510733`*^9, 
   3.747122314654456*^9}, {3.747122352668804*^9, 3.747122354116933*^9}, {
   3.747122387497159*^9, 3.747122784093178*^9}, {3.747123005174747*^9, 
   3.747123064142342*^9}, {3.747123150023451*^9, 3.747123218397501*^9}, {
   3.747215567380432*^9, 3.747215652626376*^9}, {3.747215742214069*^9, 
   3.747215788891487*^9}, 3.747296533378478*^9, {3.747312241642372*^9, 
   3.747312242535344*^9}, {3.747376736037942*^9, 3.747376740290017*^9}, {
   3.747376796237442*^9, 3.747376796377987*^9}, {3.747376846066617*^9, 
   3.7473768916112967`*^9}, 3.747376957364555*^9, {3.747462645138153*^9, 
   3.7474627406552896`*^9}, {3.747462841515655*^9, 3.747462884840288*^9}, {
   3.747462975724525*^9, 3.7474630120953903`*^9}, 3.747463254220458*^9, {
   3.747465454298058*^9, 3.747465469320595*^9}, {3.74748110214454*^9, 
   3.7474811267710543`*^9}, {3.74748116521229*^9, 3.747481165386428*^9}, {
   3.7476387540356216`*^9, 3.747638755681383*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"db78b205-a416-4027-8661-9195665415d0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Slowness, L1/L2 matrices", "Subsection",
 CellChangeTimes->{{3.747376755757457*^9, 3.747376792529705*^9}, {
  3.747376913761466*^9, 3.747376930176058*^9}, {3.748161080898367*^9, 
  3.748161085460907*^9}},ExpressionUUID->"aa2026d7-da1a-430a-9a75-\
38fead6a5fd8"],

Cell["\<\
Requires run of the cijCarcione function to get frequency-dependent cij[i]\
\>", "CodeText",
 CellChangeTimes->{{3.7473769873020897`*^9, 3.7473770422542973`*^9}, 
   3.7474189443722467`*^9},ExpressionUUID->"7ddb0035-6cfb-483b-8421-\
770e6389f206"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GetLStovasUrsin", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c11i_", ",", " ", "c13i_", ",", " ", "c33i_", ",", " ", "c44i_", ",", 
       " ", "\[Rho]i_"}], "}"}], ",", "p_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "L1", ",", "L2", ",", "d1", ",", "d2", ",", "d3", ",", "d4", ",", "d5", 
       ",", "q\[Alpha]", ",", "q\[Beta]", ",", "\[Alpha]0", ",", "\[Beta]0", 
       ",", "\[Eta]", ",", "\[Delta]", ",", "\[Sigma]0", ",", "S\[Alpha]", 
       ",", "S\[Beta]", ",", "R", ",", "R1", ",", "R2", ",", "req1", ",", 
       "req2", ",", "imq1", ",", "imq2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]0", "=", 
       SqrtBox[
        RowBox[{"c33i", "/", "\[Rho]i"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]0", "=", 
       SqrtBox[
        RowBox[{"c44i", "/", "\[Rho]i"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]0", "=", 
       RowBox[{"1", "-", 
        FractionBox["c44i", "c33i"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]", "=", 
       FractionBox[
        RowBox[{"c13i", "-", "c33i", "+", 
         RowBox[{"2", "c44i"}]}], "c33i"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       FractionBox[
        RowBox[{
         RowBox[{"c11i", " ", "c33i"}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c13i", "+", 
            RowBox[{"2", "c44i"}]}], ")"}], "2"]}], 
        RowBox[{"2", 
         SuperscriptBox["c33i", "2"]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"R1", "=", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["p", "2"], 
           SuperscriptBox["\[Beta]0", "2"]}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Delta]", "+", 
           RowBox[{"2", 
            SuperscriptBox["p", "2"], 
            SuperscriptBox["\[Alpha]0", "2"], "\[Eta]"}]}], ")"}], "2"]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"R2", "=", 
       RowBox[{"\[Sigma]0", "+", 
        RowBox[{"2", 
         SuperscriptBox["p", "2"], 
         SuperscriptBox["\[Beta]0", "2"], "\[Delta]"}], "-", 
        RowBox[{"2", 
         SuperscriptBox["p", "2"], 
         SuperscriptBox["\[Alpha]0", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", 
            SuperscriptBox["p", "2"], 
            SuperscriptBox["\[Beta]0", "2"]}]}], ")"}], "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R", "=", 
       FractionBox["R1", 
        RowBox[{"R2", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["R2", "2"], "+", 
           RowBox[{"2", 
            SuperscriptBox["p", "2"], 
            SuperscriptBox["\[Beta]0", "2"], "R1"}]}]]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S\[Alpha]", "=", 
       RowBox[{
        RowBox[{"2", "\[Delta]"}], "+", 
        RowBox[{"2", 
         SuperscriptBox["p", "2"], 
         SuperscriptBox["\[Alpha]0", "2"], "\[Eta]"}], "+", "R"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S\[Beta]", "=", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["p", "2"], 
            SuperscriptBox["\[Beta]0", "2"]}]}], ")"}], 
         FractionBox[
          SuperscriptBox["\[Alpha]0", "2"], 
          SuperscriptBox["\[Beta]0", "2"]], "\[Eta]"}], "-", "R"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"d2", "=", 
       SqrtBox[
        FractionBox[
         RowBox[{"\[Sigma]0", "+", "\[Delta]"}], 
         RowBox[{"\[Sigma]0", "+", "S\[Alpha]"}]]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d3", "=", 
       RowBox[{"2", 
        SuperscriptBox["\[Beta]0", "2"], 
        FractionBox[
         RowBox[{"\[Sigma]0", "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"S\[Alpha]", "+", "\[Delta]"}], ")"}]}]}], 
         RowBox[{"\[Sigma]0", "+", "\[Delta]"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d4", "=", 
       SqrtBox[
        FractionBox[
         RowBox[{"\[Sigma]0", "-", 
          RowBox[{
           SuperscriptBox["p", "2"], 
           SuperscriptBox["\[Beta]0", "2"], 
           RowBox[{"(", 
            RowBox[{"\[Sigma]0", "+", "S\[Beta]"}], ")"}]}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             SuperscriptBox["p", "2"], 
             SuperscriptBox["\[Beta]0", "2"], 
             RowBox[{"(", 
              RowBox[{"1", "+", "S\[Beta]"}], ")"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Sigma]0", "+", "\[Delta]"}], ")"}]}]]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d5", "=", 
       FractionBox[
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"2", 
          SuperscriptBox["p", "2"], 
          SuperscriptBox["\[Beta]0", "2"], 
          RowBox[{"(", 
           RowBox[{"\[Sigma]0", "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"S\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"\[Sigma]0", "+", "\[Delta]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d1", "=", 
       FractionBox["1", 
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["p", "2"], "d3"}], "+", "d5"}]]]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"req1", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Alpha]0", "2"]], "-", 
         SuperscriptBox["p", "2"], "-", 
         RowBox[{
          SuperscriptBox["p", "2"], "S\[Alpha]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"req2", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Beta]0", "2"]], "-", 
         SuperscriptBox["p", "2"], "-", 
         RowBox[{
          SuperscriptBox["p", "2"], "S\[Beta]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imq1", "=", 
       RowBox[{"Im", "[", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Alpha]0", "2"]], "-", 
         SuperscriptBox["p", "2"], "-", 
         RowBox[{
          SuperscriptBox["p", "2"], "S\[Alpha]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imq2", "=", 
       RowBox[{"Im", "[", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Beta]0", "2"]], "-", 
         SuperscriptBox["p", "2"], "-", 
         RowBox[{
          SuperscriptBox["p", "2"], "S\[Beta]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imq1", "=", 
       RowBox[{
        RowBox[{"Sign", "[", "imq1", "]"}], "imq1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imq2", "=", 
       RowBox[{
        RowBox[{"Sign", "[", "imq2", "]"}], "imq2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"req1", "=", "req1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"req2", "=", "req2"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"q\[Alpha]", "=", 
       SqrtBox[
        RowBox[{"req1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "imq1"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q\[Beta]", "=", 
       SqrtBox[
        RowBox[{"req2", "+", 
         RowBox[{"\[ImaginaryI]", " ", "imq2"}]}]]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"q\[Alpha]", "=", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["\[Alpha]0", "2"]], "-", 
          SuperscriptBox["p", "2"], "-", 
          RowBox[{
           SuperscriptBox["p", "2"], "S\[Alpha]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q\[Beta]", "=", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["\[Beta]0", "2"]], "-", 
          SuperscriptBox["p", "2"], "-", 
          RowBox[{
           SuperscriptBox["p", "2"], "S\[Beta]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q\[Alpha]", "=", 
         RowBox[{
          RowBox[{"Sign", "[", 
           RowBox[{"Im", "[", "q\[Alpha]", "]"}], "]"}], "q\[Alpha]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"q\[Beta]", "=", 
         RowBox[{
          RowBox[{"Sign", "[", 
           RowBox[{"Im", "[", "q\[Beta]", "]"}], "]"}], "q\[Beta]"}]}], ";"}],
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"L1", "=", 
       RowBox[{"d1", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d2", 
             SqrtBox[
              FractionBox["q\[Alpha]", "\[Rho]i"]]}], ",", 
            RowBox[{
             FractionBox["1", "d4"], 
             FractionBox["p", 
              SqrtBox[
               RowBox[{"\[Rho]i", " ", "q\[Beta]"}]]]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d3", " ", "d2", " ", "p", " ", 
             SqrtBox[
              RowBox[{"\[Rho]i", " ", "q\[Alpha]"}]]}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "d5"}], "d4"], 
             SqrtBox[
              FractionBox["\[Rho]i", "q\[Beta]"]]}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"L2", "=", 
       RowBox[{"d1", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["d5", "d2"], 
             SqrtBox[
              FractionBox["\[Rho]i", "q\[Alpha]"]]}], ",", 
            RowBox[{"d3", " ", "d4", " ", "p", " ", 
             SqrtBox[
              RowBox[{"\[Rho]i", " ", "q\[Beta]"}]]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", "d2"], 
             FractionBox["p", 
              SqrtBox[
               RowBox[{"\[Rho]i", " ", "q\[Alpha]"}]]]}], ",", 
            RowBox[{
             RowBox[{"-", "d4"}], 
             SqrtBox[
              FractionBox["q\[Beta]", "\[Rho]i"]]}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q\[Alpha]", ",", "q\[Beta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"L1", ",", "L2"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q\[Alpha]", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "q\[Beta]"}], "}"}]}], "}"}], ",", "L1", ",", 
       "L2"}], "}"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"l1", "[", "j", "]"}], "=", 
       RowBox[{"L1", "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l2", "[", "j", "]"}], "=", 
       RowBox[{"L2", "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q1", "[", "j", "]"}], "=", 
       RowBox[{"q\[Alpha]", "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q2", "[", "j", "]"}], "=", 
       RowBox[{"q\[Beta]", "//", "N"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.747144657509535*^9, 3.7471447868422623`*^9}, {
   3.747144842540195*^9, 3.747145036463174*^9}, {3.747145096554556*^9, 
   3.747145148846468*^9}, {3.747145192924012*^9, 3.7471453352013206`*^9}, {
   3.747145387993479*^9, 3.7471455316520147`*^9}, {3.747145624988312*^9, 
   3.7471458085795507`*^9}, {3.7471458625030003`*^9, 3.747145912999799*^9}, {
   3.7471460672645617`*^9, 3.747146106374795*^9}, {3.747164255666718*^9, 
   3.747164320664784*^9}, {3.7471644140049763`*^9, 3.747164426921666*^9}, {
   3.7472030161948023`*^9, 3.747203031592656*^9}, {3.7472188893595247`*^9, 
   3.747218927876945*^9}, {3.747221512240013*^9, 3.747221522272654*^9}, {
   3.7472475260805492`*^9, 3.747247531184722*^9}, {3.74724793112337*^9, 
   3.74724794631741*^9}, {3.747294481174206*^9, 3.7472944840311117`*^9}, {
   3.747312259539938*^9, 3.747312262022614*^9}, {3.747312329605567*^9, 
   3.747312331398467*^9}, {3.7473742767146482`*^9, 3.7473742803021708`*^9}, 
   3.747376940778455*^9, 3.747382844206897*^9, {3.7474631830900373`*^9, 
   3.7474632361722507`*^9}, {3.7474633628346157`*^9, 3.747463366725185*^9}, {
   3.747469945981958*^9, 3.747469970695853*^9}, {3.747546184788455*^9, 
   3.747546239136921*^9}, {3.747546279410055*^9, 3.747546286802005*^9}, 
   3.747546908776013*^9, {3.74754727219872*^9, 3.747547345953332*^9}, {
   3.747568039474522*^9, 3.747568040504156*^9}, 3.7481635497893543`*^9, {
   3.7481698555445604`*^9, 3.748169868082901*^9}, {3.748169909031788*^9, 
   3.7481699107152543`*^9}, {3.7481699560013895`*^9, 3.7481699572727623`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"63138713-80ac-408d-a227-16b9d4c14505"],

Cell[BoxData[
 RowBox[{
  RowBox[{"qLCompiled", "=", "\[IndentingNewLine]", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cij", ",", "_Complex", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]i", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "L1", ",", "L2", ",", "d1", ",", "d2", ",", "d3", ",", "d4", ",", 
         "d5", ",", "q\[Alpha]", ",", "q\[Beta]", ",", "\[Alpha]0", ",", 
         "\[Beta]0", ",", "\[Eta]", ",", "\[Delta]", ",", "\[Sigma]0", ",", 
         "S\[Alpha]", ",", "S\[Beta]", ",", "R", ",", "R1", ",", "R2"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]0", "=", 
         SqrtBox[
          RowBox[{
           RowBox[{"cij", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/", "\[Rho]i"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Beta]0", "=", 
         SqrtBox[
          RowBox[{
           RowBox[{"cij", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "/", "\[Rho]i"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]0", "=", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"cij", "[", 
            RowBox[{"[", "4", "]"}], "]"}], 
           RowBox[{"cij", "[", 
            RowBox[{"[", "3", "]"}], "]"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]", "=", 
         FractionBox[
          RowBox[{
           RowBox[{"cij", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"cij", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "+", 
           RowBox[{"2", 
            RowBox[{"cij", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}]}], 
          RowBox[{"cij", "[", 
           RowBox[{"[", "3", "]"}], "]"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]", "=", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"cij", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"cij", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"cij", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", 
              RowBox[{"2", 
               RowBox[{"cij", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "2"]}], 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"cij", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "2"]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"R1", "=", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             SuperscriptBox["p", "2"], 
             SuperscriptBox["\[Beta]0", "2"]}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Delta]", "+", 
             RowBox[{"2", 
              SuperscriptBox["p", "2"], 
              SuperscriptBox["\[Alpha]0", "2"], "\[Eta]"}]}], ")"}], "2"]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"R2", "=", 
         RowBox[{"\[Sigma]0", "+", 
          RowBox[{"2", 
           SuperscriptBox["p", "2"], 
           SuperscriptBox["\[Beta]0", "2"], "\[Delta]"}], "-", 
          RowBox[{"2", 
           SuperscriptBox["p", "2"], 
           SuperscriptBox["\[Alpha]0", "2"], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", 
              SuperscriptBox["p", "2"], 
              SuperscriptBox["\[Beta]0", "2"]}]}], ")"}], "\[Eta]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         FractionBox["R1", 
          RowBox[{"R2", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["R2", "2"], "+", 
             RowBox[{"2", 
              SuperscriptBox["p", "2"], 
              SuperscriptBox["\[Beta]0", "2"], "R1"}]}]]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"S\[Alpha]", "=", 
         RowBox[{
          RowBox[{"2", "\[Delta]"}], "+", 
          RowBox[{"2", 
           SuperscriptBox["p", "2"], 
           SuperscriptBox["\[Alpha]0", "2"], "\[Eta]"}], "+", "R"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"S\[Beta]", "=", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              SuperscriptBox["p", "2"], 
              SuperscriptBox["\[Beta]0", "2"]}]}], ")"}], 
           FractionBox[
            SuperscriptBox["\[Alpha]0", "2"], 
            SuperscriptBox["\[Beta]0", "2"]], "\[Eta]"}], "-", "R"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"q\[Alpha]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Re", "@", "#"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Abs", "@", 
               RowBox[{"Im", "@", "#"}]}]}]}], ")"}], "&"}], "@", 
          SqrtBox[
           RowBox[{
            FractionBox["1", 
             SuperscriptBox["\[Alpha]0", "2"]], "-", 
            SuperscriptBox["p", "2"], "-", 
            RowBox[{
             SuperscriptBox["p", "2"], "S\[Alpha]"}]}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q\[Beta]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Re", "@", "#"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Abs", "@", 
               RowBox[{"Im", "@", "#"}]}]}]}], ")"}], "&"}], "@", 
          SqrtBox[
           RowBox[{
            FractionBox["1", 
             SuperscriptBox["\[Beta]0", "2"]], "-", 
            SuperscriptBox["p", "2"], "-", 
            RowBox[{
             SuperscriptBox["p", "2"], "S\[Beta]"}]}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d2", "=", 
         SqrtBox[
          FractionBox[
           RowBox[{"\[Sigma]0", "+", "\[Delta]"}], 
           RowBox[{"\[Sigma]0", "+", "S\[Alpha]"}]]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d3", "=", 
         RowBox[{"2", 
          SuperscriptBox["\[Beta]0", "2"], 
          FractionBox[
           RowBox[{"\[Sigma]0", "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"S\[Alpha]", "+", "\[Delta]"}], ")"}]}]}], 
           RowBox[{"\[Sigma]0", "+", "\[Delta]"}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d4", "=", 
         SqrtBox[
          FractionBox[
           RowBox[{"\[Sigma]0", "-", 
            RowBox[{
             SuperscriptBox["p", "2"], 
             SuperscriptBox["\[Beta]0", "2"], 
             RowBox[{"(", 
              RowBox[{"\[Sigma]0", "+", "S\[Beta]"}], ")"}]}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               SuperscriptBox["p", "2"], 
               SuperscriptBox["\[Beta]0", "2"], 
               RowBox[{"(", 
                RowBox[{"1", "+", "S\[Beta]"}], ")"}]}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"\[Sigma]0", "+", "\[Delta]"}], ")"}]}]]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d5", "=", 
         FractionBox[
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"2", 
            SuperscriptBox["p", "2"], 
            SuperscriptBox["\[Beta]0", "2"], 
            RowBox[{"(", 
             RowBox[{"\[Sigma]0", "+", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"S\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}]}]}], 
          RowBox[{"\[Sigma]0", "+", "\[Delta]"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d1", "=", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["p", "2"], "d3"}], "+", "d5"}]]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"L1", "=", 
         RowBox[{"d1", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"d2", 
               SqrtBox[
                FractionBox["q\[Alpha]", "\[Rho]i"]]}], ",", 
              RowBox[{
               FractionBox["1", "d4"], 
               FractionBox["p", 
                SqrtBox[
                 RowBox[{"\[Rho]i", " ", "q\[Beta]"}]]]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"d3", " ", "d2", " ", "p", " ", 
               SqrtBox[
                RowBox[{"\[Rho]i", " ", "q\[Alpha]"}]]}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"-", "d5"}], "d4"], 
               SqrtBox[
                FractionBox["\[Rho]i", "q\[Beta]"]]}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"L2", "=", 
         RowBox[{"d1", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               FractionBox["d5", "d2"], 
               SqrtBox[
                FractionBox["\[Rho]i", "q\[Alpha]"]]}], ",", 
              RowBox[{"d3", " ", "d4", " ", "p", " ", 
               SqrtBox[
                RowBox[{"\[Rho]i", " ", "q\[Beta]"}]]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               FractionBox["1", "d2"], 
               FractionBox["p", 
                SqrtBox[
                 RowBox[{"\[Rho]i", " ", "q\[Alpha]"}]]]}], ",", 
              RowBox[{
               RowBox[{"-", "d4"}], 
               SqrtBox[
                FractionBox["q\[Beta]", "\[Rho]i"]]}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"q\[Alpha]", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "q\[Beta]"}], "}"}]}], "}"}], ",", "L1", ",", 
          "L2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", " ", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.747631872350299*^9, 3.747631902494712*^9}, {
   3.747631958898806*^9, 3.747631996808082*^9}, {3.7476320294552402`*^9, 
   3.7476320424626303`*^9}, {3.747632101540482*^9, 3.747632137667864*^9}, {
   3.747632927085699*^9, 3.7476329414564753`*^9}, {3.747632974309992*^9, 
   3.74763311371392*^9}, {3.747633409604445*^9, 3.7476334391280937`*^9}, {
   3.747633697899619*^9, 3.74763373513489*^9}, {3.7476338031658487`*^9, 
   3.7476338317997217`*^9}, {3.747633881774453*^9, 3.747633915681889*^9}, {
   3.7476339706540737`*^9, 3.747633971470195*^9}, {3.747634020164242*^9, 
   3.74763403991584*^9}, {3.7476340794199457`*^9, 3.74763419823074*^9}, {
   3.747634301932486*^9, 3.74763432952425*^9}, 3.747634424196074*^9, {
   3.7476346293461313`*^9, 3.747634629449667*^9}, {3.747643992132195*^9, 
   3.747644005645019*^9}, {3.7476442190374193`*^9, 3.747644239331298*^9}, {
   3.747726167407013*^9, 3.747726237464766*^9}, {3.7481682833426447`*^9, 
   3.7481682979874945`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"e19a226e-593f-4959-a641-555f09bc95e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"qL", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c11i_", ",", " ", "c13i_", ",", " ", "c33i_", ",", " ", "c44i_", ",", 
       " ", "\[Rho]i_"}], "}"}], ",", 
     RowBox[{"p_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"qLCompiled", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c11i", ",", " ", "c13i", ",", " ", "c33i", ",", " ", "c44i"}], 
      "}"}], ",", " ", "\[Rho]i", ",", "p"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.747633187893921*^9, 3.7476331889564123`*^9}, {
   3.747633220747635*^9, 3.7476332668930492`*^9}, {3.747633558082571*^9, 
   3.7476335596005917`*^9}, {3.747633764900051*^9, 3.74763376597773*^9}, {
   3.747633814729652*^9, 3.747633822497365*^9}, 3.747634397568671*^9, 
   3.748168380261752*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"46eb411f-d3bf-4190-a84a-642b73214ba8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Reflectivity and transmissivity", "Subsection",
 CellChangeTimes->{{3.747376755757457*^9, 3.747376792529705*^9}, {
  3.747376913761466*^9, 3.747376930176058*^9}, {3.748161080898367*^9, 
  3.748161122293969*^9}},ExpressionUUID->"bf065e10-b1cf-4791-9a14-\
3674ad00f459"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"REFLECTIVITY", " ", "ONLY"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stackRefExperiment2", "[", 
     RowBox[{
      RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", 
      RowBox[{"p_", "?", "NumericQ"}], ",", 
      RowBox[{"CijsAnd\[Rho]", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_"}], "}"}], 
         ".."}], "}"}]}], ",", " ", "d_List"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ArrayQ", "[", "d", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "@", "d"}], "\[Equal]", 
        RowBox[{"Length", "@", "CijsAnd\[Rho]"}]}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "qABArray", ",", " ", "L1ar", ",", "L2ar", ",", " ", "L12Array", ",", 
       "CArray", ",", "DArray", ",", "refArray", ",", " ", "transArray", ",", 
       " ", "phaseArray", ",", " ", "foldArray", ",", "f"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qABArray", ",", " ", "L1ar", ",", " ", "L2ar"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"qL", "[", 
           RowBox[{"#", ",", "p"}], "]"}], "&"}], "/@", "CijsAnd\[Rho]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L12Array", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"L1ar", ",", " ", "L2ar"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"CArray", ",", "DArray"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ".", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RotateLeft", "@", "L12Array"}], ",", "L12Array"}], 
           "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"transArray", " ", ",", " ", "refArray"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Inverse", "[", 
                RowBox[{"#1", "+", "#2"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"(", 
                RowBox[{"#1", "-", "#2"}], ")"}], "]"}], ".", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Inverse", "[", 
                RowBox[{"#1", "+", "#2"}], "]"}]}]}]}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"CArray", ",", " ", "DArray"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phaseArray", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", 
           RowBox[{"(", 
            RowBox[{"qABArray", " ", "d"}], ")"}]}], "]"}], "-", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "1."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", 
           RowBox[{"Length", "[", "d", "]"}]}], "]"}]}], "//", "Chop"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"foldArray", "=", 
       RowBox[{"Reverse", "@", 
        RowBox[{"Most", "@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"transArray", ",", "refArray", ",", " ", "phaseArray"}], 
           "}"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#4", ".", 
          RowBox[{"(", 
           RowBox[{"#3", "+", 
            RowBox[{
             RowBox[{"Transpose", "[", "#2", "]"}], ".", "#1", ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
               RowBox[{"#3", ".", "#1"}]}], "]"}], ".", "#2"}]}], ")"}], ".", 
          "#4"}], ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"#1", ",", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "foldArray"}], 
       "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"transArray", ",", "refArray", ",", " ", "phaseArray"}], 
       "}"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"foldArray", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Most", "@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"transArray", ",", "refArray", ",", " ", "phaseArray"}], 
          "}"}], "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{";", "\[IndentingNewLine]", 
      RowBox[{"phaseArray", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "\[Omega]", 
         RowBox[{"(", 
          RowBox[{"qABArray", " ", "d"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"foldArray", "=", 
       RowBox[{"Reverse", "@", 
        RowBox[{"Most", "@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"transArray", ",", "refArray", ",", " ", "phaseArray"}], 
           "}"}], "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.748081217799539*^9, {3.74808129919536*^9, 3.748081302325453*^9}, {
   3.748081422927822*^9, 3.7480814596291533`*^9}, {3.748081642043152*^9, 
   3.748081644664382*^9}, {3.748081782122211*^9, 3.748081784711622*^9}, {
   3.748081930967084*^9, 3.7480819342779093`*^9}, {3.748081976603219*^9, 
   3.7480819898729773`*^9}, {3.748086023145913*^9, 3.748086026145265*^9}, {
   3.74808621596025*^9, 3.748086244741735*^9}, 3.748086304710166*^9, {
   3.748086369476879*^9, 3.7480865306598663`*^9}, {3.748086562986905*^9, 
   3.74808662037327*^9}, {3.748088584676117*^9, 3.748088585979105*^9}, {
   3.748088636397079*^9, 3.748088668964531*^9}, {3.748088753554801*^9, 
   3.748088778046401*^9}, {3.7480888238708143`*^9, 3.748088842760363*^9}, {
   3.748088905549971*^9, 3.748088907291031*^9}, {3.748160962079929*^9, 
   3.7481609652345247`*^9}, {3.7481610471357727`*^9, 3.74816105022423*^9}, {
   3.7481630759154453`*^9, 3.7481630866528378`*^9}, {3.748163219544882*^9, 
   3.748163222145549*^9}, {3.7481632971146483`*^9, 3.7481632994528513`*^9}, {
   3.748163417538108*^9, 3.7481634367791533`*^9}, {3.7481635675826693`*^9, 
   3.7481635678764524`*^9}, {3.748170546207245*^9, 3.7481705528408027`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"ddbe2a2b-33ab-4868-ae3c-17030ae9fe75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
   "BOTH", " ", "REFLECTIVITY", " ", "AND", " ", "TRANSMISSIVITY", 
    "\[IndentingNewLine]", 
    RowBox[{"OUPUT", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "IS", " ", "TRANSMISSIVITY", " ", 
    "MATRIX", "\[IndentingNewLine]", 
    RowBox[{"OUPUT", "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", "IS", " ", "REFLECTIVITY", " ", 
    "MATRIX"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stackRefExperiment2RT", "[", 
     RowBox[{"\[Omega]_", ",", "p_", ",", 
      RowBox[{"CijsAnd\[Rho]", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_"}], "}"}], 
         ".."}], "}"}]}], ",", " ", "d_List"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ArrayQ", "[", "d", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "@", "d"}], "\[Equal]", 
        RowBox[{"Length", "@", "CijsAnd\[Rho]"}]}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "qABArray", ",", " ", "L1ar", ",", "L2ar", ",", " ", "L12Array", ",", 
       "CArray", ",", "DArray", ",", "refArray", ",", " ", "transArray", ",", 
       " ", "phaseArray", ",", " ", "foldArray", ",", "fR", ",", "fT"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qABArray", ",", " ", "L1ar", ",", " ", "L2ar"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"qL", "[", 
           RowBox[{"#", ",", "p"}], "]"}], "&"}], "/@", "CijsAnd\[Rho]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L12Array", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"L1ar", ",", " ", "L2ar"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"CArray", ",", "DArray"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ".", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RotateLeft", "@", "L12Array"}], ",", "L12Array"}], 
           "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"transArray", " ", ",", " ", "refArray"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Inverse", "[", 
                RowBox[{"#1", "+", "#2"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"(", 
                RowBox[{"#1", "-", "#2"}], ")"}], "]"}], ".", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Inverse", "[", 
                RowBox[{"#1", "+", "#2"}], "]"}]}]}]}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"CArray", ",", " ", "DArray"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phaseArray", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", 
           RowBox[{"(", 
            RowBox[{"qABArray", " ", "d"}], ")"}]}], "]"}], "-", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "1."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", 
           RowBox[{"Length", "[", "d", "]"}]}], "]"}]}], "//", "Chop"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"foldArray", "=", 
       RowBox[{"Reverse", "@", 
        RowBox[{"Most", "@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"transArray", ",", "refArray", ",", " ", "phaseArray"}], 
           "}"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fR", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#4", ".", 
          RowBox[{"(", 
           RowBox[{"#3", "+", 
            RowBox[{
             RowBox[{"Transpose", "[", "#2", "]"}], ".", "#1", ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
               RowBox[{"#3", ".", "#1"}]}], "]"}], ".", "#2"}]}], ")"}], ".", 
          "#4"}], ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fT", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
            RowBox[{"#3", ".", 
             RowBox[{"fR", "[", 
              RowBox[{"#5", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], 
           "]"}], ".", "#2", ".", "#4"}], ")"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Fold", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fT", "[", 
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"#1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"fR", "[", 
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
        "foldArray"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7481609483712664`*^9, 3.7481610455785456`*^9}, 
   3.748163577713608*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"b17b506d-5a69-45d1-a8d1-10e9d1f14517"],

Cell[BoxData[
 RowBox[{"<<", "CompiledFunctionTools`"}]], "Input",
 CellChangeTimes->{{3.747732866491877*^9, 3.7477328664936132`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ba1d8ada-d434-4775-b72f-6e205d1c62e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stackRefExperiment", "[", 
    RowBox[{"\[Omega]_", ",", "p_", ",", 
     RowBox[{"CijsAnd\[Rho]", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_"}], "}"}], ".."}],
        "}"}]}], ",", " ", "d_List"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ArrayQ", "[", "d", "]"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "@", "d"}], "\[Equal]", 
       RowBox[{"Length", "@", "CijsAnd\[Rho]"}]}], ")"}]}], ")"}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "qABArray", ",", " ", "L12Array", ",", "CArray", ",", "DArray", ",", 
      "refArray", ",", " ", "transArray", ",", " ", "phaseArray", ",", " ", 
      "foldArray", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qABArray", ",", " ", "L12Array"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetLStovasUrsin", "[", 
          RowBox[{"#", ",", "p"}], "]"}], "&"}], "/@", "CijsAnd\[Rho]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CArray", ",", "DArray"}], "}"}], "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"#1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ".", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RotateLeft", "@", "L12Array"}], ",", "L12Array"}], 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"transArray", " ", ",", " ", "refArray"}], "}"}], "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"Transpose", "@", 
              RowBox[{"Inverse", "[", 
               RowBox[{"#1", "+", "#2"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"(", 
               RowBox[{"#1", "-", "#2"}], ")"}], "]"}], ".", 
             RowBox[{"Transpose", "@", 
              RowBox[{"Inverse", "[", 
               RowBox[{"#1", "+", "#2"}], "]"}]}]}]}], "}"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"CArray", ",", " ", "DArray"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phaseArray", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "#1"}], "]"}], 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "#2"}], "]"}]}], 
           "}"}]}], "}"}], "&"}], "@@@", 
       RowBox[{"(", 
        RowBox[{"qABArray", " ", "d"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"foldArray", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Most", "@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"transArray", ",", "refArray", ",", " ", "phaseArray"}], 
          "}"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#4", ".", 
         RowBox[{"(", 
          RowBox[{"#3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", "#2", "]"}], ".", "#1", ".", 
            RowBox[{"Inverse", "[", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
              RowBox[{"#3", ".", "#1"}]}], "]"}], ".", "#2"}]}], ")"}], ".", 
         "#4"}], ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "foldArray"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.74763675587466*^9, 3.7476368963729887`*^9}, {
   3.747636971421583*^9, 3.74763697620394*^9}, {3.7476370169864683`*^9, 
   3.747637030129373*^9}, {3.747637075327847*^9, 3.74763707915868*^9}, {
   3.7476371737751513`*^9, 3.747637233082361*^9}, {3.747637264403428*^9, 
   3.747637269945384*^9}, {3.747637318681024*^9, 3.7476373274553127`*^9}, {
   3.747637370191145*^9, 3.747637382438341*^9}, {3.747637431951044*^9, 
   3.747637447339295*^9}, {3.7476375266187983`*^9, 3.74763752935212*^9}, {
   3.747637563989428*^9, 3.747637657899994*^9}, {3.7476377071097527`*^9, 
   3.747637748600946*^9}, {3.747637781124876*^9, 3.7476378000402193`*^9}, {
   3.747638026234003*^9, 3.747638028680345*^9}, {3.748088530492985*^9, 
   3.748088532865138*^9}, 3.748088619825428*^9, {3.748088681992937*^9, 
   3.7480886889153433`*^9}, {3.748088739441575*^9, 3.7480887406021852`*^9}, {
   3.748088788105398*^9, 3.748088790867527*^9}, {3.748088856602511*^9, 
   3.748088892020687*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e634895c-37b0-4e69-9eac-21794dc36da3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stackRefTransCoefs", "[", 
    RowBox[{"\[Omega]_", ",", "p_", ",", 
     RowBox[{"CijsAnd\[Rho]", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_"}], "}"}], ".."}],
        "}"}]}], ",", " ", "d_List"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ArrayQ", "[", "d", "]"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "@", "d"}], "\[Equal]", 
       RowBox[{"Length", "@", "CijsAnd\[Rho]"}]}], ")"}]}], ")"}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "qABArray", ",", " ", "L12Array", ",", "CArray", ",", "DArray", ",", 
      "refArray", ",", " ", "transArray", ",", " ", "phaseArray", ",", " ", 
      "foldArray", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qABArray", ",", " ", "L12Array"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetLStovasUrsin", "[", 
          RowBox[{"#", ",", "p"}], "]"}], "&"}], "/@", "CijsAnd\[Rho]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CArray", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "#1", "]"}], ".", "#2"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RotateLeft", "@", 
           RowBox[{"L12Array", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"L12Array", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DArray", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "#1", "]"}], ".", "#2"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RotateLeft", "@", 
           RowBox[{"L12Array", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"L12Array", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transArray", "=", 
      RowBox[{"2", 
       RowBox[{"Transpose", "/@", " ", 
        RowBox[{"Inverse", "/@", 
         RowBox[{"(", 
          RowBox[{"CArray", "+", "DArray"}], ")"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"refArray", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", ".", "#2"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Transpose", "/@", 
            RowBox[{"(", 
             RowBox[{"CArray", "-", "DArray"}], ")"}]}], ",", "transArray"}], 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phaseArray", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "#1"}], "]"}], 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "#2"}], "]"}]}], 
           "}"}]}], "}"}], "&"}], "@@@", 
       RowBox[{"(", 
        RowBox[{"qABArray", " ", "d"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"foldArray", "=", 
      RowBox[{"Reverse", "@", 
       RowBox[{"Most", "@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"transArray", ",", "refArray", ",", " ", "phaseArray"}], 
          "}"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#4", ".", 
         RowBox[{"(", 
          RowBox[{"#3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", "#2", "]"}], ".", "#1", ".", 
            RowBox[{"Inverse", "[", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
              RowBox[{"#3", ".", "#1"}]}], "]"}], ".", "#2"}]}], ")"}], ".", 
         "#4"}], ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "foldArray"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.747555608005961*^9, 3.747555753258423*^9}, {
   3.747555890171571*^9, 3.747555956081686*^9}, {3.7475559989224043`*^9, 
   3.747556010129097*^9}, {3.7475562169802322`*^9, 3.747556227697433*^9}, {
   3.747556262008429*^9, 3.747556275271633*^9}, {3.74755644140516*^9, 
   3.7475565038880663`*^9}, {3.747556568375897*^9, 3.7475566217811413`*^9}, {
   3.747556803662681*^9, 3.74755683391006*^9}, {3.747556909363254*^9, 
   3.747557064398746*^9}, {3.74755709551928*^9, 3.7475571019973927`*^9}, {
   3.7475571482302094`*^9, 3.747557251121316*^9}, {3.747557284736432*^9, 
   3.74755733467837*^9}, {3.7475574320141163`*^9, 3.747557455770465*^9}, 
   3.74755909948695*^9, {3.747559130539483*^9, 3.7475591464717073`*^9}, {
   3.747559184121533*^9, 3.7475592363563347`*^9}, {3.7475592858781147`*^9, 
   3.7475592862246532`*^9}, {3.7475593559957037`*^9, 3.747559357057309*^9}, {
   3.747559440481435*^9, 3.747559441935639*^9}, {3.747559955960231*^9, 
   3.74755995622073*^9}, {3.747560016956656*^9, 3.747560017411149*^9}, {
   3.7475653651631823`*^9, 3.7475653899353456`*^9}, 3.747565504662695*^9, {
   3.747565546939814*^9, 3.7475656047526197`*^9}, {3.747565674344746*^9, 
   3.74756573440341*^9}, 3.747565851988043*^9, 3.747565935376108*^9, {
   3.747566001214603*^9, 3.747566002403901*^9}, {3.7475678804049664`*^9, 
   3.7475678829036093`*^9}, {3.747568067711347*^9, 3.747568072764374*^9}, {
   3.747568145324336*^9, 3.747568152202157*^9}, {3.7475684197794333`*^9, 
   3.74756848637429*^9}, {3.747568671265724*^9, 3.7475686903198853`*^9}, {
   3.747568794837668*^9, 3.747568848682014*^9}, {3.7475689100827503`*^9, 
   3.7475689277440166`*^9}, {3.7475690289583473`*^9, 3.747569137905196*^9}, {
   3.747569208282239*^9, 3.747569331899601*^9}, {3.747569366235539*^9, 
   3.747569439518632*^9}, {3.747569482096428*^9, 3.747569507317397*^9}, {
   3.7475695623891077`*^9, 3.747569567243656*^9}, {3.747569602586689*^9, 
   3.747569628825963*^9}, {3.7475698641884623`*^9, 3.7475698923139563`*^9}, {
   3.747570001710972*^9, 3.74757000215718*^9}, {3.7475700505319357`*^9, 
   3.74757007985842*^9}, {3.7475702110000877`*^9, 3.747570213799655*^9}, {
   3.7475705607073708`*^9, 3.747570580019402*^9}, 3.747570652325571*^9, {
   3.747571233441557*^9, 3.7475712876118717`*^9}, {3.7475713271898823`*^9, 
   3.747571331362451*^9}, {3.747571439152083*^9, 3.747571584418634*^9}, {
   3.747571624929181*^9, 3.7475717654290743`*^9}, 3.747571859895982*^9, {
   3.747571917376864*^9, 3.747571955535079*^9}, 3.747572001028906*^9, {
   3.747635038476562*^9, 3.747635060912736*^9}, {3.747635096908558*^9, 
   3.747635106509342*^9}, {3.747635229395138*^9, 3.747635249218822*^9}, {
   3.747635308564817*^9, 3.74763533422733*^9}, {3.7481632768037677`*^9, 
   3.7481632859981585`*^9}, {3.7481634207416067`*^9, 
   3.7481634395865984`*^9}, {3.7481635735896416`*^9, 3.7481635745331507`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"d1b0567f-ffd6-4ec6-b5d3-fa7ac7bae802"]
}, Closed]],

Cell[CellGroupData[{

Cell["Time-domain description", "Subsection",
 CellChangeTimes->{{3.747376755757457*^9, 3.747376792529705*^9}, {
  3.747376913761466*^9, 3.747376930176058*^9}, {3.748161080898367*^9, 
  3.748161122293969*^9}, {3.7481659473532043`*^9, 
  3.7481659558528643`*^9}},ExpressionUUID->"24e23425-c5be-4b69-8a20-\
615758d6bc01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"addSrcRec", "[", 
    RowBox[{"RT_", ",", "\[Omega]_", ",", "zs_", ",", "zr_", ",", "qAB1_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "exp", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"exp", "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", "z", " ", "qAB1"}], 
         "]"}], "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"exp", "[", "zs", "]"}], ".", "RT", ".", 
         RowBox[{"exp", "[", "zr", "]"}]}], "//", "N"}], "//", "Chop"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integrand", "[", 
   RowBox[{"RT_", ",", "x_", ",", 
    RowBox[{"p_", "?", "NumericQ"}], ",", "\[Omega]_"}], "]"}], ":=", 
  RowBox[{"RT", " ", 
   RowBox[{"BesselJ", "[", 
    RowBox[{"1", ",", 
     RowBox[{"x", " ", "p", " ", "\[Omega]"}]}], "]"}], "p", " ", 
   SuperscriptBox["\[Omega]", "2"], " "}]}]}], "Input",
 CellChangeTimes->{
  3.748081217799539*^9, {3.74808129919536*^9, 3.748081302325453*^9}, {
   3.748081422927822*^9, 3.7480814596291533`*^9}, {3.748081642043152*^9, 
   3.748081644664382*^9}, {3.748081782122211*^9, 3.748081784711622*^9}, {
   3.748081930967084*^9, 3.7480819342779093`*^9}, {3.748081976603219*^9, 
   3.7480819898729773`*^9}, {3.748086023145913*^9, 3.748086026145265*^9}, {
   3.74808621596025*^9, 3.748086244741735*^9}, 3.748086304710166*^9, {
   3.748086369476879*^9, 3.7480865306598663`*^9}, {3.748086562986905*^9, 
   3.74808662037327*^9}, {3.748088584676117*^9, 3.748088585979105*^9}, {
   3.748088636397079*^9, 3.748088668964531*^9}, {3.748088753554801*^9, 
   3.748088778046401*^9}, {3.7480888238708143`*^9, 3.748088842760363*^9}, {
   3.748088905549971*^9, 3.748088907291031*^9}, {3.748160962079929*^9, 
   3.7481609652345247`*^9}, {3.7481610471357727`*^9, 3.74816105022423*^9}, {
   3.7481630759154453`*^9, 3.7481630866528378`*^9}, {3.748163219544882*^9, 
   3.748163222145549*^9}, {3.7481632971146483`*^9, 3.7481632994528513`*^9}, {
   3.748163417538108*^9, 3.7481634367791533`*^9}, {3.7481635675826693`*^9, 
   3.7481635678764524`*^9}, {3.748165960437085*^9, 3.748166111836695*^9}, {
   3.7481661810320673`*^9, 3.7481662586509895`*^9}, {3.7481686789651327`*^9, 
   3.748168681848782*^9}, {3.748169564981106*^9, 3.748169575228354*^9}, {
   3.7481696316523905`*^9, 3.7481696803960047`*^9}, {3.748170220641249*^9, 
   3.748170222872183*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"6efafe00-0bd2-4936-85d3-c4e30adbbf6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical testing", "Subsection",
 CellChangeTimes->{{3.747376755757457*^9, 3.747376792529705*^9}, {
  3.747376913761466*^9, 3.747376930176058*^9}, {3.7481610690736427`*^9, 
  3.7481610746062107`*^9}},ExpressionUUID->"b9a0e559-e977-4bcb-84fe-\
98ea291bb321"],

Cell[BoxData[
 RowBox[{
  RowBox[{"binarymodel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", "shale", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "22.56", ",", "12.38", ",", "17.35", ",", "3.15", ",", "2.38", ",", 
       "100", ",", "50"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "sandstone", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "26.73", ",", "12.51", ",", "26.73", ",", "7.11", ",", "2.22", ",", 
       "150", ",", "100"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "siltstone", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "60.13", ",", "38.26", ",", "50.87", ",", "17.17", ",", "2.18", ",", 
       "100", ",", "50"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7481611395428357`*^9, 3.74816114136067*^9}, {
  3.7481614526313667`*^9, 3.7481614529752817`*^9}, {3.7481644609993825`*^9, 
  3.74816446428913*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"30278ee1-bdad-494f-9f36-cc8013096086"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrep", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"binarymodel", ",", 
       RowBox[{"{", "nrep", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"nrep", ",", "7"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7481611496035876`*^9, 3.748161153853909*^9}, 
   3.748161264759799*^9, {3.7481621473691998`*^9, 3.7481621499931464`*^9}, 
   3.748163637061421*^9, 3.7481705105716724`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"1aecccf8-5f85-4b1f-b1eb-625ef29d538c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "2018", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dList", "=", 
   RowBox[{
    RowBox[{"ArrayPad", "[", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", ".1"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "model", "]"}], "-", "2"}]}], "]"}], ",", 
      "1"}], "]"}], "/", "1000"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7481611634183226`*^9, 3.7481612157705317`*^9}, {
   3.748162118267109*^9, 3.7481621189177914`*^9}, 3.748162300895407*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"898e37d1-7bf3-4bac-a58d-fb2477340795"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Omega]comp", "=", 
   RowBox[{"2", " ", "Pi", " ", "40"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.748161236448517*^9, 3.7481612400541043`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"c2d0bc3b-209a-48e9-b6da-a30cb59aeb98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cijsNum", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"cijCarcione", "[", 
      RowBox[{"#", ",", "150", ",", "\[Omega]comp"}], " ", "]"}], "&"}], "/@",
     "model"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7475597918221493`*^9, 3.7475598050885572`*^9}, {
  3.748161277456563*^9, 3.7481612885781593`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"7ef98c1f-0395-4684-a56f-cc3e59384db1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "=", "1"}], ",", 
     RowBox[{"zs", "=", ".1"}], ",", 
     RowBox[{"zr", "=", ".2"}], ",", 
     RowBox[{"\[Omega]", "=", "\[Omega]comp"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Re", "@", 
      RowBox[{"integrand", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"addSrcRec", "[", 
          RowBox[{
           RowBox[{"stackRefExperiment2", "[", 
            RowBox[{"\[Omega]", ",", "p", ",", "cijsNum", ",", " ", "dList"}],
             "]"}], ",", "\[Omega]", ",", "zs", ",", "zr", ",", 
           RowBox[{
            RowBox[{"qL", "[", 
             RowBox[{
              RowBox[{"cijsNum", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "x", ",", "p", ",", 
        "\[Omega]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Full"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7481619944845076`*^9, 3.7481621092311554`*^9}, {
   3.7481621586882668`*^9, 3.748162278771578*^9}, {3.7481623128361588`*^9, 
   3.748162378558922*^9}, {3.74816261713986*^9, 3.7481626425103235`*^9}, {
   3.7481626967756433`*^9, 3.748162698394926*^9}, {3.748163659534176*^9, 
   3.7481636990522585`*^9}, {3.748166659170904*^9, 3.748166665734402*^9}, {
   3.7481667108957963`*^9, 3.74816682126302*^9}, {3.748166893447071*^9, 
   3.7481668938070283`*^9}, {3.748166944229105*^9, 3.7481669788279953`*^9}, {
   3.748167013560133*^9, 3.7481670356908417`*^9}, {3.748167072991784*^9, 
   3.748167075087343*^9}, {3.7481671139474316`*^9, 3.748167157766676*^9}, 
   3.7481672756794753`*^9, {3.7481673204412193`*^9, 3.7481673206728334`*^9}, {
   3.7481697079763446`*^9, 3.748169748844014*^9}, {3.7481698778428545`*^9, 
   3.7481698788886347`*^9}, {3.748169950042582*^9, 3.7481699502681804`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"e5cf36f5-c503-4f30-a30a-72d9d477ab14"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag$17227#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 0.9999999795918367}, {-739.7819756264447, 
   1186.0511300028693`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.748166807318846*^9, 3.7481668217453055`*^9}, {
   3.7481669541705914`*^9, 3.748166974153626*^9}, {3.7481670081437654`*^9, 
   3.7481670221619525`*^9}, {3.748167057178872*^9, 3.748167079139123*^9}, {
   3.7481671180683637`*^9, 3.748167163645271*^9}, 3.7481680363805027`*^9, {
   3.748169703833374*^9, 3.7481697151344256`*^9}, 3.7481697523543816`*^9, 
   3.7481698824892406`*^9, 3.7481699173679667`*^9, 3.748169965040369*^9, 
   3.7481705148630867`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"a5a56912-54aa-4964-aef4-043638bde052"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pars", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<GlobalAdaptive\>\"", ",", 
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}], ",", 
         RowBox[{"\"\<MaxErrorIncreases\>\"", "\[Rule]", "2000"}]}], "}"}]}], 
      ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "20"}], ",", 
      RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "8"}], ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "=", "1"}], ",", 
     RowBox[{"zs", "=", ".1"}], ",", 
     RowBox[{"zr", "=", ".2"}], ",", 
     RowBox[{"\[Omega]", "=", "\[Omega]comp"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"integrand", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"addSrcRec", "[", 
         RowBox[{
          RowBox[{"stackRefExperiment2", "[", 
           RowBox[{"\[Omega]", ",", "p", ",", "cijsNum", ",", " ", "dList"}], 
           "]"}], ",", "\[Omega]", ",", "zs", ",", "zr", ",", 
          RowBox[{
           RowBox[{"qL", "[", 
            RowBox[{
             RowBox[{"cijsNum", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "x", ",", "p", ",", 
       "\[Omega]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.748162656245847*^9, 3.748162743352501*^9}, {
   3.7481680532312098`*^9, 3.7481680617738657`*^9}, {3.748168206638163*^9, 
   3.7481682301174483`*^9}, {3.7481683177589445`*^9, 
   3.7481683196018333`*^9}, {3.7481684523439517`*^9, 
   3.7481684881910458`*^9}, {3.748168688319949*^9, 3.748168725535676*^9}, {
   3.748168853615446*^9, 3.7481688541127653`*^9}, {3.7481689303679934`*^9, 
   3.748168981112608*^9}, {3.748169012720459*^9, 3.748169039310997*^9}, {
   3.7481691329483986`*^9, 3.748169141314593*^9}, {3.7481691815092225`*^9, 
   3.7481692099617004`*^9}, {3.748169471809354*^9, 3.748169476017544*^9}, 
   3.748169775614017*^9, {3.7481699416433*^9, 3.74816994717297*^9}, {
   3.74817001613792*^9, 3.7481700167004128`*^9}, {3.7481700689778695`*^9, 
   3.748170100515333*^9}, {3.74817014632557*^9, 3.748170151024007*^9}, 
   3.748170184946782*^9, {3.748170229591939*^9, 3.7481702297132587`*^9}, {
   3.7481703144705696`*^9, 3.7481703512309723`*^9}, 3.7481705293274612`*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"ea8c2e57-8741-47c2-bcae-0902e2194e90"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","nmtx",
   "\"The first two levels of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"qL\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"22.590341665770147`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.11523765600082647`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.393899836978706`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.05233533073485304`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"17.38034166577015`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.115237656000826`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"3.158220914395721`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.03145116263298631`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.38`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qL\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"26.75662645270025`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.517908387568184`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.02973685932376819`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"26.75662645270025`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"7.119359032566032`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.035449090618586476`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.22`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qL\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"60.2252650393922`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.362539795256683`\\\", \\\
\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"38.26564402340837`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"21\\\", \\\"\
\[RightSkeleton]\\\"}], \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\",\
\\\", RowBox[{RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"19\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"\[VeryThinSpace]\\\"}], \\\"-\\\", \
RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"19\\\", \
\\\"\[RightSkeleton]\\\"}], \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
\\\"2.18`\\\"}], \\\"}\\\"}], \\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"qL\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"22.590341665770147`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.11523765600082647`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.393899836978706`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.05233533073485304`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"17.38034166577015`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.115237656000826`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"3.158220914395721`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.03145116263298631`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.38`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qL\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"26.75662645270025`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.517908387568184`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.02973685932376819`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"26.75662645270025`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"7.119359032566032`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.035449090618586476`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.22`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}]}], \\\"}\\\"}]\\) cannot be \
transposed.\"",2,28,19,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705616130743`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"4fc07830-77ff-4f8d-9e9b-bbf2c049cf01"],

Cell[BoxData[
 TemplateBox[{
  "Set","shape",
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"qABArray$20715\\\", \\\",\
\\\", \\\"L1ar$20715\\\", \\\",\\\", \\\"L2ar$20715\\\"}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"qL\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"22.590341665770147`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.11523765600082647`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.393899836978706`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.05233533073485304`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"17.38034166577015`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.115237656000826`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"3.158220914395721`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.03145116263298631`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.38`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qL\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"26.75662645270025`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.517908387568184`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.02973685932376819`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"26.75662645270025`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"7.119359032566032`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.035449090618586476`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.22`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qL\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"60.2252650393922`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.362539795256683`\\\", \\\
\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\",\
\\\", \\\"2.18`\\\"}], \\\"}\\\"}], \\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"qL\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"22.590341665770147`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.11523765600082647`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.393899836978706`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.05233533073485304`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"17.38034166577015`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.115237656000826`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"3.158220914395721`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.03145116263298631`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.38`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qL\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"26.75662645270025`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"12.517908387568184`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"-\\\", RowBox[{\\\"0.02973685932376819`\\\", \\\" \\\", \\\"\[ImaginaryI]\
\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"26.75662645270025`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.10063504056093972`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"7.119359032566032`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\
\\\", RowBox[{\\\"0.035449090618586476`\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \\\"2.22`\\\"}], \\\"}\\\"}], \
\\\",\\\", \\\"p\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\) are not \
the same shape.\"",2,28,20,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705616461663`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"48fd32d9-9899-4e51-9250-3d4e930ec346"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","nmtx",
   "\"The first two levels of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"L1ar$20715\\\", \\\",\\\", \\\"L2ar$20715\\\"}], \\\"}\\\"}]\\) \
cannot be transposed.\"",2,28,21,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.748170561671228*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"22c6f01a-2966-4bd9-bf5a-c543ccba6652"],

Cell[BoxData[
 TemplateBox[{
  "MapThread","mptd",
   "\"Object \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"L1ar$20715\\\", \\\",\\\", \
\\\"L2ar$20715\\\"}], \\\"}\\\"}], \\\"]\\\"}]\\) at position {2, \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\)} in \\!\\(\\*RowBox[{\\\"MapThread\\\", \\\"[\
\\\", RowBox[{RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"#1\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\".\\\", RowBox[{\\\"#2\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"#1\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\".\\\", RowBox[{\\\"#2\\\", \\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \
\\\"\[RightDoubleBracket]\\\"}]}]}], \\\"}\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"L1ar$20715\\\", \\\",\\\", \
\\\"L2ar$20715\\\"}], \\\"}\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"L1ar$20715\\\", \\\",\\\", \\\"L2ar$20715\\\"}], \\\"}\\\"}], \
\\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) has only \
\\!\\(\\*RowBox[{\\\"0\\\"}]\\) of required \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \
dimensions.\"",2,28,22,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705616952925`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"e5fe2e86-8a8e-488e-a0ee-ce23a00c9e90"],

Cell[BoxData[
 TemplateBox[{
  "Set","shape",
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"CArray$20715\\\", \\\",\\\
\", \\\"DArray$20715\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"Transpose\
\\\", \\\"[\\\", RowBox[{\\\"MapThread\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"Transpose\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\".\\\", RowBox[{\\\"#2\\\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \
\\\"\[RightDoubleBracket]\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"Transpose\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\".\\\", RowBox[{\\\"#2\\\", \\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \
\\\"\[RightDoubleBracket]\\\"}]}]}], \\\"}\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"L1ar$20715\\\", \\\",\\\", \
\\\"L2ar$20715\\\"}], \\\"}\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"L1ar$20715\\\", \\\",\\\", \\\"L2ar$20715\\\"}], \\\"}\\\"}], \
\\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\"]\\\"}]\\) are not the same \
shape.\"",2,28,23,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705617233653`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"567e644a-4ab5-4e26-bd30-18c497286ce2"],

Cell[BoxData[
 TemplateBox[{
  "MapThread","mptd",
   "\"Object \\!\\(\\*RowBox[{\\\"CArray$20715\\\"}]\\) at position {2, \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\)} in \\!\\(\\*RowBox[{\\\"MapThread\\\", \\\"[\
\\\", RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"2\\\", \\\" \
\\\", RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"Inverse\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"+\\\", RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"#1\\\", \\\"-\\\", RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\"]\\\"}], \\\".\\\", RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"Inverse\\\", \\\"[\\\", RowBox[{RowBox[{\\\"Slot\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\"]\\\"}], \\\"]\\\"}]}]}], \\\"}\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"CArray$20715\\\", \\\",\\\", \
\\\"DArray$20715\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) has only \
\\!\\(\\*RowBox[{\\\"0\\\"}]\\) of required \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \
dimensions.\"",2,28,24,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.748170561751461*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"eebf29f4-738c-4681-a980-99a41fdc8327"],

Cell[BoxData[
 TemplateBox[{
  "Set","shape",
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"transArray$20715\\\", \
\\\",\\\", \\\"refArray$20715\\\"}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"MapThread\\\", \
\\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"2\\\", \\\" \
\\\", RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"Inverse\\\", \
\\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\
\"Transpose\\\", \\\"[\\\", RowBox[{\\\"Inverse\\\", \\\"[\\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}]}], \
\\\"}\\\"}], \\\"&\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"CArray$20715\\\", \\\",\\\", \\\"DArray$20715\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\"]\\\"}]\\) are not the same shape.\"",2,28,25,
   27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705617785435`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"739d3109-447e-4338-a7ff-6069d6bb1e59"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Set\\\", \\\"::\\\", \\\
\"shape\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,28,26,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705618026085`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"e8fc4536-9172-452d-9a75-95d99d0a81fe"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","nmtx",
   "\"The first two levels of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"transArray$20715\\\", \\\",\\\", \\\"refArray$20715\\\", \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"1.`\\\
\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"0.`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"0.009000185226844416`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\")\\\"}], \\\" \\\", \
\\\"qABArray$20715\\\"}]], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.`\\\"}], \\\"+\\\", SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"0.`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"0.009000185226844416`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\")\\\"}], \\\" \\\", \
\\\"qABArray$20715\\\"}]]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.009000185226844416`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]]}], \\\",\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.009000185226844416`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]]}], \\\"}\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.004738686526643291`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]], \\\",\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"0.`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"0.004738686526643291`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\")\\\"}], \\\" \\\", \
\\\"qABArray$20715\\\"}]]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.004738686526643291`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]]}], \\\",\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.004738686526643291`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]]}], \\\"}\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.02094537187526698`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]], \\\",\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"0.`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"0.02094537187526698`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\")\\\"}], \\\" \\\", \
\\\"qABArray$20715\\\"}]]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.02094537187526698`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]]}], \\\",\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.02094537187526698`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \
\\\")\\\"}], \\\" \\\", \\\"qABArray$20715\\\"}]]}], \\\"}\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"1.`\\\"}], \\\"}\\\"}]}], \
\\\"}\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}]\\) cannot be transposed.\"",2,28,27,
   27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.748170561825638*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"10b1f0d7-b1fa-43f8-9c0b-dc54cbb3fbeb"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Transpose\\\", \\\"::\\\
\", \\\"nmtx\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,28,28,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705618527093`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"e418bbf3-d712-4e76-a46e-a84d7fa51a9f"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","argt",
   "\"\\!\\(\\*RowBox[{\\\"Transpose\\\"}]\\) called with \\!\\(\\*RowBox[{\\\
\"0\\\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"",2,28,29,
   27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705618787785`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"bdab3d4f-db1a-4198-9ef5-33d0e6c44eb4"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","argt",
   "\"\\!\\(\\*RowBox[{\\\"Transpose\\\"}]\\) called with \\!\\(\\*RowBox[{\\\
\"0\\\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"",2,28,30,
   27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.74817056190184*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"a9ca861d-7e1c-4531-bc70-545801776ceb"],

Cell[BoxData[
 TemplateBox[{
  "Thread","tdlen",
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"11.66050775340398`\\\"}], \\\"+\\\", \
RowBox[{\\\"13.851223559077388`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"3.3134802570438135`\\\"}], \\\"-\\\", \
RowBox[{\\\"1.7040502364202972`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"17.94298735063431`\\\"}], \\\"-\\\", \
RowBox[{\\\"2.4234355955345905`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.4796520285074284`\\\"}], \\\"-\\\", \
RowBox[{\\\"1.6340120332411956`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"0.9921147013144787`\\\"}], \\\"-\\\", \
RowBox[{\\\"0.1253332335642977`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]}], \
\\\"}\\\"}], \\\"+\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\
\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}]\\) cannot be combined.\"",2,28,
   31,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705619259043`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"e9fdbf2f-cbf4-4abc-adb3-881e7bf32fb7"],

Cell[BoxData[
 TemplateBox[{
  "Thread","tdlen",
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"55.88895301634614`\\\"}], \\\"-\\\", \
RowBox[{\\\"323.02459940950763`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"8.075364205575065`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"11.292673630778994`\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"316.07775497931885`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"86.96734847150819`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\
\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"0.48062519931087905`\\\"}], \
\\\"+\\\", RowBox[{\\\"4.835538439181766`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\
\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"0.9685831611286344`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"0.248689887164842`\\\", \\\" \
\\\", \\\"\[ImaginaryI]\\\"}]}]}], \\\"}\\\"}], \\\"+\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]}]\\) cannot be combined.\"",2,28,32,
   27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705619489937`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"74d94f44-ff25-4a07-9158-cebc613ad87f"],

Cell[BoxData[
 TemplateBox[{
  "Thread","tdlen",
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.`\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\"+\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"11.66050775340398`\\\"}], \\\"+\\\", \
RowBox[{\\\"13.851223559077388`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"3.3134802570438135`\\\"}], \\\"-\\\", \
RowBox[{\\\"1.7040502364202972`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"17.94298735063431`\\\"}], \\\"-\\\", \
RowBox[{\\\"2.4234355955345905`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.4796520285074284`\\\"}], \\\"-\\\", \
RowBox[{\\\"1.6340120332411956`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}], \\\
\",\\\", RowBox[{RowBox[{\\\"-\\\", \\\"0.9921147013144787`\\\"}], \\\"-\\\", \
RowBox[{\\\"0.1253332335642977`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]}], \
\\\"}\\\"}]}]\\) cannot be combined.\"",2,28,33,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705619740314`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"3ec8e77e-9371-464a-846b-40b938462ca6"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Thread\\\", \\\"::\\\", \
\\\"tdlen\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,28,34,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705620041122`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"c92923e2-665a-493c-be55-938c7d879b81"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inum",
   "\"Integrand \\!\\(\\*RowBox[{\\\"integrand\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", RowBox[{\\\"-\\\", \\\"1.`\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\",\\\", \\\"0\
\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"p\\\", \\\",\\\", RowBox[{\\\"80\\\", \\\" \\\", \\\"\[Pi]\\\"}]}], \\\"]\
\\\"}]\\) is not numerical at \\!\\(\\*RowBox[{\\\"{\\\", \\\"p\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"0.007957319952578756`\\\", \
\\\"}\\\"}]\\).\"",2,28,35,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.7481705620261717`*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"aa7346ec-01e6-4181-862c-229741035570"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inum",
   "\"Integrand \\!\\(\\*RowBox[{\\\"integrand\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", RowBox[{\\\"-\\\", \\\"1.`\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\",\\\", \\\"0\
\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"p\\\", \\\",\\\", RowBox[{\\\"80\\\", \\\" \\\", \\\"\[Pi]\\\"}]}], \\\"]\
\\\"}]\\) is not numerical at \\!\\(\\*RowBox[{\\\"{\\\", \\\"p\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"0.007957319952578756`\\\", \
\\\"}\\\"}]\\).\"",2,28,36,27110949555105542110,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.748170532668288*^9, 3.748170562051237*^9}},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"f486cb14-8947-4622-b58d-a39ddb5fc3a5"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.7481690330815077`*^9, 3.7481692109914317`*^9, 3.7481694775145626`*^9, 
   3.7481697781518173`*^9, {3.7481699390013003`*^9, 3.748169971179676*^9}, 
   3.7481700176068463`*^9, 3.748170101634328*^9, {3.748170147400416*^9, 
   3.74817015165571*^9}, 3.7481701856185627`*^9, 3.748170230440216*^9, {
   3.748170315200528*^9, 3.7481703314766073`*^9}, 3.748170432582782*^9, {
   3.748170531649644*^9, 3.7481705675979514`*^9}},
 CellLabel->"Out[28]=",ExpressionUUID->"4697dccf-4810-412c-a5bf-5b8a1b45c340"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "=", "1"}], ",", 
     RowBox[{"zs", "=", ".1"}], ",", 
     RowBox[{"zr", "=", ".2"}], ",", 
     RowBox[{"\[Omega]", "=", "\[Omega]comp"}], ",", 
     RowBox[{"p", "=", ".2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"integrand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"addSrcRec", "[", 
       RowBox[{
        RowBox[{"stackRefExperiment2", "[", 
         RowBox[{"\[Omega]", ",", "p", ",", "cijsNum", ",", " ", "dList"}], 
         "]"}], ",", "\[Omega]", ",", "zs", ",", "zr", ",", 
        RowBox[{
         RowBox[{"qL", "[", 
          RowBox[{
           RowBox[{"cijsNum", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "x", ",", "p", ",", 
     "\[Omega]"}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7481700279642935`*^9, 3.7481700546990795`*^9}, {
   3.748170303944744*^9, 3.7481703070098248`*^9}, 3.748170780094572*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"69a12e91-0321-4da6-8c7c-f0a813b76087"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1.0227325706723696`"}], "+", 
  RowBox[{"0.07870968894089636`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.748170030735685*^9, 3.748170054907667*^9}, {
  3.7481703050737333`*^9, 3.748170307246451*^9}, {3.748170775233678*^9, 
  3.748170780482603*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"39590e3c-ed6d-4120-8106-b99288941852"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"RepeatedTiming", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stackRefExperiment2", "[", 
          RowBox[{"\[Omega]comp", ",", "p", ",", "cijsNum", ",", "dList"}], 
          "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "1", ",", ".01"}], "}"}]}], "]"}], ",", 
      "10"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RepeatedTiming", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stackRefExperiment2RT", "[", 
          RowBox[{"\[Omega]comp", ",", "p", ",", "cijsNum", ",", "dList"}], 
          "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "1", ",", ".01"}], "}"}]}], "]"}], ",", 
      "10"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7481616039627705`*^9, 3.7481616750780735`*^9}, {
  3.7481617218835335`*^9, 3.7481617228260403`*^9}, {3.7481617556222677`*^9, 
  3.7481617648748517`*^9}, {3.748161812385187*^9, 3.7481618570377207`*^9}, {
  3.7481619704618998`*^9, 3.7481619737917128`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"cb63265d-9771-4015-b0d2-2b6b28ca1a07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6933305036665957655`3.", ",", "0.9842892682233850277`2."}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.74816160443603*^9, 3.7481616581228285`*^9}, {
   3.7481617199925065`*^9, 3.748161733080308*^9}, 3.7481618360400877`*^9, 
   3.7481618676578283`*^9, 3.748161995347761*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"5661e5ec-3476-462d-9603-2ce5a658b31f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Stovas and Ursin (2003) and Ursin and Stovas (2002) reflectivity examples\
\>", "Section",
 CellChangeTimes->{{3.7473773381799393`*^9, 3.747377347721385*^9}, {
  3.7473810680377293`*^9, 3.747381088021717*^9}, {3.747387221887478*^9, 
  3.747387230470008*^9}},ExpressionUUID->"a7709b23-ba22-4f44-8d10-\
6a9e0601c295"],

Cell[CellGroupData[{

Cell["Single interface reflectivity", "Subsection",
 CellChangeTimes->{{3.74737706065038*^9, 
  3.747377091039295*^9}},ExpressionUUID->"722ba902-75ea-441d-9400-\
c7e60c355260"],

Cell["Requires precomputed L1/L2 matrices and vertical slowness", "CodeText",
 CellChangeTimes->{{3.747377094531076*^9, 
  3.7473771281059017`*^9}},ExpressionUUID->"2c812491-40d7-4377-90b4-\
01e89ef4746f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RT", "[", 
    RowBox[{"LBelow_", ",", "LAbove_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L1a", "=", 
        RowBox[{"LAbove", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"L1b", "=", 
        RowBox[{"LBelow", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"L2a", "=", 
        RowBox[{"LAbove", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"L2b", "=", 
        RowBox[{"LBelow", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "C", 
       ",", "D", ",", "inv", ",", "RD", ",", "RU", ",", "TD", ",", "TU"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "L2a", "]"}], ".", "L1b"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"D", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "L1a", "]"}], ".", "L2b"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inv", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"C", "+", "D"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TD", "=", 
       RowBox[{"2", "inv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RD", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"C", "-", "D"}], ")"}], ".", "inv"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"TU", "=", 
         RowBox[{"TD", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RU", "=", 
         RowBox[{"-", "RD"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TD", ",", "RD"}], "}"}], "//", "N"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.74737714414402*^9, 3.7473771567390347`*^9}, {
   3.747386246271549*^9, 3.747386380386039*^9}, {3.747388148371814*^9, 
   3.7473881515430737`*^9}, {3.747463521805231*^9, 3.7474636269617357`*^9}, {
   3.747466020724393*^9, 3.747466024343987*^9}, 3.747481422953588*^9, {
   3.747481470865049*^9, 3.7474814734543257`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"435dfc3c-988a-4c72-839c-2ff4eead17f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stack reflectivity (recursion)", "Subsection",
 CellChangeTimes->{{3.74737706065038*^9, 3.747377091039295*^9}, {
  3.747377174388645*^9, 
  3.747377178494112*^9}},ExpressionUUID->"a9cfd93a-0e1d-4373-a7ac-\
b559a18f8d04"],

Cell["\<\
Requires precomputed L1/L2 matrices and vertical slowness and single \
interface reflectivities.
Note:
1. each layer has the same index as the bottom interface
2. N layers = N interfaces - 1
3. topmost and bottommost layers are half-spaces with zero thickness\
\>", "CodeText",
 CellChangeTimes->{{3.747377094531076*^9, 3.7473771281059017`*^9}, {
  3.747377185357017*^9, 3.7473773015395327`*^9}, {3.747386085249978*^9, 
  3.747386088165648*^9}},ExpressionUUID->"bb684405-7a58-47fc-bdf2-\
51d6d8edc0e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"q1", "[", 
    RowBox[{"j_Integer", ",", "q_"}], "]"}], ":=", 
   RowBox[{"q", "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q2", "[", 
    RowBox[{"j_Integer", ",", "q_"}], "]"}], ":=", 
   RowBox[{"q", "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TD", "[", 
    RowBox[{"j_Integer", ",", "RT_"}], "]"}], ":=", 
   RowBox[{"RT", "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RD", "[", 
    RowBox[{"j_Integer", ",", "RT_"}], "]"}], ":=", 
   RowBox[{"RT", "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dz", "[", 
    RowBox[{"j_Integer", ",", "d_"}], "]"}], ":=", 
   RowBox[{"d", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.747464369154496*^9, 3.747464448973194*^9}, {
  3.747464502104636*^9, 3.747464539251306*^9}, {3.747464574075479*^9, 
  3.747464576446293*^9}, {3.747464803501793*^9, 3.7474648039296923`*^9}, {
  3.747464868884595*^9, 3.747464884291209*^9}, {3.747467303827208*^9, 
  3.7474673097973022`*^9}, {3.747468826574232*^9, 3.747468842395701*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"c7bf3000-b46d-468b-9324-5f271387d923"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"j_Integer", ",", "\[Omega]_", ",", "q_", ",", "d_"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", 
           RowBox[{"q1", "[", 
            RowBox[{"j", ",", "q"}], "]"}], " ", 
           RowBox[{"dz", "[", 
            RowBox[{"j", ",", "d"}], "]"}]}], ")"}], "]"}], ",", "0"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", 
           RowBox[{"q2", "[", 
            RowBox[{"j", ",", "q"}], "]"}], " ", 
           RowBox[{"dz", "[", 
            RowBox[{"j", ",", "d"}], "]"}]}], ")"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rd", "[", 
     RowBox[{
     "n_Integer", ",", "n_Integer", ",", "\[Omega]_", ",", "q_", ",", "d_", 
      ",", "RT_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rd", "[", 
     RowBox[{
     "j_Integer", ",", "n_Integer", ",", "\[Omega]_", ",", "q_", ",", "d_", 
      ",", "RT_"}], "]"}], "/;", 
    RowBox[{"j", "<", "n"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rd", "[", 
     RowBox[{"j", ",", "n", ",", "\[Omega]", ",", "q", ",", "d", ",", "RT"}], 
     "]"}], "=", 
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"j", ",", "\[Omega]", ",", "q", ",", "d"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RD", "[", 
        RowBox[{"j", ",", "RT"}], "]"}], "+", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"TD", "[", 
          RowBox[{"j", ",", "RT"}], "]"}], "]"}], ".", 
        RowBox[{"rd", "[", 
         RowBox[{
          RowBox[{"j", "+", "1"}], ",", "n", ",", "\[Omega]", ",", "q", ",", 
          "d", ",", "RT"}], "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
           RowBox[{
            RowBox[{"RD", "[", 
             RowBox[{"j", ",", "RT"}], "]"}], ".", 
            RowBox[{"rd", "[", 
             RowBox[{
              RowBox[{"j", "+", "1"}], ",", "n", ",", "\[Omega]", ",", "q", 
              ",", "d", ",", "RT"}], "]"}]}]}], ")"}], "]"}], ".", 
        RowBox[{"TD", "[", 
         RowBox[{"j", ",", "RT"}], "]"}]}]}], ")"}], ".", 
     RowBox[{"e", "[", 
      RowBox[{"j", ",", "\[Omega]", ",", "q", ",", "d"}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.747163845508862*^9, 3.747163862672423*^9}, {
   3.7471640304030333`*^9, 3.74716404001593*^9}, {3.747164361186268*^9, 
   3.747164362032873*^9}, {3.7471644296541643`*^9, 3.747164502362705*^9}, {
   3.747202687289022*^9, 3.747202689112164*^9}, {3.7472031679470663`*^9, 
   3.747203222779009*^9}, {3.747203283531275*^9, 3.747203406998454*^9}, {
   3.747203654412258*^9, 3.7472036953672533`*^9}, 3.747203817236168*^9, {
   3.747215059182816*^9, 3.7472150596292562`*^9}, {3.747218067649604*^9, 
   3.747218093303177*^9}, 3.7472186277612753`*^9, {3.7472506720800343`*^9, 
   3.7472506742654657`*^9}, {3.7472507496257772`*^9, 
   3.7472507675182133`*^9}, {3.747250819079406*^9, 3.747250825756518*^9}, {
   3.747250903801794*^9, 3.74725093150486*^9}, {3.74725103176219*^9, 
   3.747251070886033*^9}, {3.7472511503945227`*^9, 3.7472511739658623`*^9}, {
   3.747251219882577*^9, 3.747251269141663*^9}, {3.747251975290206*^9, 
   3.747251975822818*^9}, {3.747252769077539*^9, 3.747252805386879*^9}, {
   3.747252908382009*^9, 3.747252918118752*^9}, {3.747286139518532*^9, 
   3.747286172298842*^9}, {3.747286813501539*^9, 3.747286845273505*^9}, 
   3.747286957393119*^9, {3.747287211693326*^9, 3.747287218081573*^9}, {
   3.747292638185237*^9, 3.7472926438034363`*^9}, {3.7472927054897413`*^9, 
   3.7472927125568*^9}, {3.747293124623253*^9, 3.7472931518390627`*^9}, {
   3.7472932859544277`*^9, 3.7472934404527407`*^9}, {3.747293495719116*^9, 
   3.747293500709125*^9}, {3.747293610105194*^9, 3.747293625268311*^9}, {
   3.747293718066258*^9, 3.7472937389117317`*^9}, {3.7472937736303253`*^9, 
   3.747293773685669*^9}, {3.747293839299378*^9, 3.7472938418380003`*^9}, {
   3.7472938922616796`*^9, 3.747293894089344*^9}, {3.747294360567745*^9, 
   3.747294379357284*^9}, {3.7472953397725153`*^9, 3.747295347051383*^9}, {
   3.7472953837804127`*^9, 3.747295391141919*^9}, {3.74729553160388*^9, 
   3.747295536995893*^9}, {3.747312001140862*^9, 3.747312001319447*^9}, {
   3.74731206923376*^9, 3.747312123005577*^9}, {3.747312381648435*^9, 
   3.747312412985236*^9}, {3.747313698977236*^9, 3.74731370511364*^9}, 
   3.747330165744399*^9, {3.747374296383954*^9, 3.7473742985013742`*^9}, 
   3.7473746327510023`*^9, {3.747379078185266*^9, 3.747379104646002*^9}, {
   3.7473791586426907`*^9, 3.747379211544668*^9}, {3.747379370401703*^9, 
   3.747379371357798*^9}, {3.747463829567528*^9, 3.7474638486363564`*^9}, {
   3.74746388877485*^9, 3.747463968603859*^9}, {3.747464002214793*^9, 
   3.7474640881713753`*^9}, 3.7474642437704773`*^9, {3.747464409456913*^9, 
   3.747464413993824*^9}, {3.747464459736068*^9, 3.7474644984322977`*^9}, {
   3.747464567077983*^9, 3.747464661942869*^9}, {3.7474647400851507`*^9, 
   3.747464743174271*^9}, {3.74746481081406*^9, 3.747464813510756*^9}, {
   3.747465069929253*^9, 3.747465098011145*^9}, 3.7474675313185377`*^9, {
   3.7474688360225887`*^9, 3.7474688460383463`*^9}, 3.747472063234023*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"b53c50af-18cf-4715-a27a-8a7a49c8b870"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.747555273288772*^9, 3.7475553068706408`*^9}, 
   3.7475556026458406`*^9},ExpressionUUID->"e0f8eff9-72f6-45cf-9b5a-\
fd7d96f32878"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "phaseFactor", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phaseFactor", "[", 
    RowBox[{"\[Omega]_", ",", 
     RowBox[{"d_", "/;", 
      RowBox[{"ArrayQ", "[", "d", "]"}]}]}], "]"}], ":="}], ";"}]}], "Input",
 CellChangeTimes->{{3.747554543815078*^9, 3.747554586003271*^9}, {
   3.7475546287217913`*^9, 3.7475546786502113`*^9}, {3.747554740089767*^9, 
   3.747554878811604*^9}, {3.747554912266361*^9, 3.747554921393324*^9}, 
   3.747554993917985*^9, {3.747555245690262*^9, 
   3.7475552532642384`*^9}},ExpressionUUID->"eded190d-6e7d-421d-badd-\
899fcd7f6c28"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.747554684377343*^9, 3.747554687697315*^9}, 
   3.747554918907013*^9},ExpressionUUID->"69b48a8e-3f6a-46b2-ad61-\
10aac0b5fe58"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "45"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "23", ",", "3"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.747554589357366*^9, 3.747554609420073*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"dbeb9f6a-7f91-4218-a592-75baea961db1"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.7475545978509274`*^9, 3.7475546097673798`*^9}},
 CellLabel->"Out[48]=",ExpressionUUID->"d63a0628-85f2-430f-a389-7bfc574dc25e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rock Physics Input", "Subsection",
 CellChangeTimes->{{3.74737706065038*^9, 3.747377091039295*^9}, {
  3.747377174388645*^9, 3.747377178494112*^9}, {3.7473773663300533`*^9, 
  3.7473773717451363`*^9}, {3.747377436124074*^9, 3.747377438141183*^9}, {
  3.747381098223908*^9, 3.747381217810768*^9}, {3.747381299518055*^9, 
  3.747381311024928*^9}, {3.74748391116861*^9, 
  3.747483914390914*^9}},ExpressionUUID->"e796478a-6d6e-4604-902d-\
8413ef35dd10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"someFunction", "[", 
   RowBox[{"fractureDensity_", ",", " ", "waterSaturation_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[Omega]_", ",", "\[Tau]0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Out", "[", 
   RowBox[{"{", 
    RowBox[{
    "c11", ",", " ", "c13", ",", " ", "c33", ",", " ", "c44", ",", " ", 
     "\[Rho]bulk"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.747483927536304*^9, 3.747483971277813*^9}, {
   3.747484007772831*^9, 3.747484068115604*^9}, {3.747484265575683*^9, 
   3.74748428376602*^9}, 3.747484376507517*^9, {3.747484474850819*^9, 
   3.747484476040928*^9}},ExpressionUUID->"08cfc3f2-bfe0-4b4b-8c99-\
5916ab9ccad1"],

Cell[BoxData[
 RowBox[{"M", "[", "\[Omega]", "]"}]], "Input",
 CellChangeTimes->{{3.747484182816392*^9, 
  3.74748419355991*^9}},ExpressionUUID->"695ffed5-5637-4d3a-acff-\
24d6982e85b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Declare model", "Subsection",
 CellChangeTimes->{{3.74737706065038*^9, 3.747377091039295*^9}, {
  3.747377174388645*^9, 3.747377178494112*^9}, {3.7473773663300533`*^9, 
  3.7473773717451363`*^9}, {3.747377436124074*^9, 3.747377438141183*^9}, {
  3.747381098223908*^9, 3.747381217810768*^9}, {3.747381299518055*^9, 
  3.747381311024928*^9}},ExpressionUUID->"20efa2a7-db76-4e32-936b-\
60ad8ce5ba25"],

Cell["\<\
3 interfaces: [number of the interface]
-> chalk/shale (iso)\t\t\t[1]
-> shale/sandstone (vti) \t\t[3]
-> siltstone/sandstone (vti)\t[5]
\
\>", "CodeText",
 CellChangeTimes->{{3.747381237286489*^9, 3.7473812397159977`*^9}, {
   3.747381311811564*^9, 3.7473813248292713`*^9}, 3.7473813570101*^9, {
   3.747387212419718*^9, 3.7473872326081448`*^9}, {3.747387263552884*^9, 
   3.74738733615974*^9}},ExpressionUUID->"2c5a3fc1-7173-400a-a9b1-\
f83a895feec4"],

Cell["Model parameters : {c11, c13, c33, c44, \[Rho], Q1, Q2}", "CodeText",
 CellChangeTimes->{{3.747381237286489*^9, 3.7473812397159977`*^9}, {
   3.747381311811564*^9, 3.7473813248292713`*^9}, 
   3.747381360077013*^9},ExpressionUUID->"de058845-3743-46b7-bfa2-\
9d118eec7154"],

Cell[BoxData[
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"chalk", " ", 
      RowBox[{"(", "iso", ")"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox["vp", "2"], "den"}], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["vp", "2"], "den"}], "-", 
           RowBox[{"2", 
            SuperscriptBox["vs", "2"], "den"}]}], ",", 
          RowBox[{
           SuperscriptBox["vp", "2"], "den"}], ",", 
          RowBox[{
           SuperscriptBox["vs", "2"], "den"}], ",", "den", ",", "350", ",", 
          "350"}], "}"}], "/.", 
        RowBox[{"vp", "\[Rule]", "4.5"}]}], "/.", 
       RowBox[{"vs", "\[Rule]", "2.5"}]}], "/.", 
      RowBox[{"den", "\[Rule]", "2.75"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"shale", " ", 
       RowBox[{"(", "iso", ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox["vp", "2"], "den"}], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["vp", "2"], "den"}], "-", 
           RowBox[{"2", 
            SuperscriptBox["vs", "2"], "den"}]}], ",", 
          RowBox[{
           SuperscriptBox["vp", "2"], "den"}], ",", 
          RowBox[{
           SuperscriptBox["vs", "2"], "den"}], ",", "den", ",", "100", ",", 
          "50"}], "}"}], "/.", 
        RowBox[{"vp", "\[Rule]", "2.92"}]}], "/.", 
       RowBox[{"vs", "\[Rule]", "1.4"}]}], "/.", 
      RowBox[{"den", "\[Rule]", "2.18"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "shale", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "22.56", ",", "12.38", ",", "17.35", ",", "3.15", ",", "2.38", ",", 
       "100", ",", "50"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "sandstone", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "26.73", ",", "12.51", ",", "26.73", ",", "7.11", ",", "2.22", ",", 
       "150", ",", "100"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "siltstone", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "60.13", ",", "38.26", ",", "50.87", ",", "17.17", ",", "2.18", ",", 
       "100", ",", "50"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "sandstone", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "26.73", ",", "12.51", ",", "26.73", ",", "7.11", ",", "2.22", ",", 
       "150", ",", "100"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.747381196847084*^9, 3.747381200659994*^9}, {
  3.7473872788877077`*^9, 3.747387279114326*^9}, {3.747389172978537*^9, 
  3.747389174802328*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"237e7007-6244-4f59-b397-35966def350c"],

Cell["Layer thickness is computed randomly for further tests", "CodeText",
 CellChangeTimes->{{3.747381237286489*^9, 3.7473812397159977`*^9}, {
   3.747381311811564*^9, 3.7473813248292713`*^9}, 3.747381360077013*^9, {
   3.7473814255775146`*^9, 
   3.747381440772973*^9}},ExpressionUUID->"80021aaa-5de0-4220-b44d-\
36c5cf660f70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dList", "=", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "2018", "]"}], ";", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", ".1"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "model", "]"}], "-", "2"}]}], "]"}]}], ",", 
     RowBox[{"{", "0", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.747381496001664*^9, 3.7473815036462183`*^9}, {
  3.747381565008761*^9, 3.7473815903032227`*^9}, {3.747467443547345*^9, 
  3.747467443984645*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"79c9a561-9195-49df-99fd-22aa5a1f6d33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"model", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]], "Input",
 CellChangeTimes->{{3.747558925712261*^9, 3.74755895706022*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"c16176f2-ee9f-4650-a20f-9e30eddaab01"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{{3.7475589286776323`*^9, 3.747558957351956*^9}},
 CellLabel->
  "Out[123]=",ExpressionUUID->"3cf668a3-8460-4180-a713-31da95bc5122"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RTinterface2", "[", ".1", "]"}], "//", "Length"}]], "Input",
 CellChangeTimes->{{3.747558900583681*^9, 3.747558919941725*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"59f4b858-3bf1-425a-9925-e6d29d75de0b"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{{3.747558905209559*^9, 3.747558920306493*^9}},
 CellLabel->
  "Out[120]=",ExpressionUUID->"ba384fca-6673-45f3-a50d-d07f47da48f6"]
}, Open  ]],

Cell["\<\
Get frequency-dependent cij, matrices L1/L2 and slowness for a given f0 and a \
given signal frequency f\
\>", "CodeText",
 CellChangeTimes->{{3.747381237286489*^9, 3.7473812397159977`*^9}, {
  3.747381366351882*^9, 3.7473813905470037`*^9}, {3.747381619306817*^9, 
  3.747381640615485*^9}},ExpressionUUID->"d80aefa0-4c75-45c4-bada-\
5dc630f229e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f0", "=", "150"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]comp", "=", 
    RowBox[{"2", "Pi", " ", "f"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qList", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "model", "]"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LList", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "[", "model", "]"}], ",", "2", ",", "2", ",", "2"}],
        "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"qList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"LList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "=", 
      RowBox[{"GetLStovasUrsin", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cijCarcione", "[", 
         RowBox[{
          RowBox[{"model", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "f0", ",", "\[Omega]comp"}], 
         "]"}], "\[IndentingNewLine]", ",", "p"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.747381397730344*^9, {3.74738158785711*^9, 3.747381591496645*^9}, {
   3.74738162310544*^9, 3.747381651860203*^9}, {3.747381694085472*^9, 
   3.747381698462969*^9}, 3.747387863596039*^9, {3.747465239037078*^9, 
   3.747465300001153*^9}, {3.747465347096356*^9, 3.747465383984589*^9}, {
   3.74746557712718*^9, 3.747465661644718*^9}, {3.747465848566166*^9, 
   3.747465848684079*^9}, 3.747482465399357*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"b208fd7d-2555-4646-a874-5ae98de352b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"qp", "[", 
    RowBox[{"p_", ",", " ", 
     RowBox[{"f_:", "f0"}], ",", 
     RowBox[{"\[Omega]_:", "\[Omega]comp"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"GetLStovasUrsin", "[", 
      RowBox[{
       RowBox[{"cijCarcione", "[", 
        RowBox[{"#", ",", "f", ",", "\[Omega]"}], "]"}], ",", "p"}], "]"}], 
     "&"}], "/@", "model"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7474824727496643`*^9, 3.7474825214351254`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"f24b6038-070e-431d-a4df-fdf4ec38e5e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RTinterface2", "[", 
    RowBox[{"p_", ",", " ", 
     RowBox[{"f_:", "f0"}], ",", " ", 
     RowBox[{"\[Omega]_:", "\[Omega]comp"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "L"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q", ",", "L"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"qp", "[", 
         RowBox[{"p", ",", "f", ",", " ", "\[Omega]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{"RT", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RotateLeft", "@", "L"}], ",", "L"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7474825427954807`*^9, 3.747482546746377*^9}, {
  3.7474825921144753`*^9, 3.747482737333898*^9}, {3.747482896826913*^9, 
  3.7474828987055483`*^9}, {3.7474829417457047`*^9, 3.747482986015499*^9}, {
  3.747483175077462*^9, 3.747483180418515*^9}, {3.7474832850267467`*^9, 
  3.74748328539198*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"187dfd08-daa2-45b8-9d2f-d3bab472130c"],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"RTinterface2", ",", " ", "Listable"}], "]"}]], "Input",
 CellChangeTimes->{{3.747483387566668*^9, 3.747483401461773*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"7b560cad-ba7e-498f-b29b-a806bdbec97d"],

Cell[BoxData[
 RowBox[{"ClearAll", "@", "RTinterface2"}]], "Input",
 CellChangeTimes->{{3.7474829886467743`*^9, 3.747482995977784*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"3917d3e4-b8ba-4860-9c14-1628780e219f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7474837245589743`*^9, 
  3.74748373805299*^9}},ExpressionUUID->"45bed839-51cb-4841-8b26-\
636011a0f2fc"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Re", "@", 
    RowBox[{
     RowBox[{"RTinterface2", "[", 
      RowBox[{"s", ",", "f0", ",", "\[Omega]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", "0", ",", ".1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"2", "\[Pi]", " ", "10"}], ",", 
     RowBox[{"2", "\[Pi]", " ", "200"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.747483555985725*^9, 3.7474836545101423`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"ad13ff55-dc09-4ba2-9bb3-2ede95e1c6dd"],

Cell["\<\
Calculate reflection-transmission coefficients for each interface\
\>", "CodeText",
 CellChangeTimes->{{3.747381237286489*^9, 3.7473812397159977`*^9}, {
  3.747381366351882*^9, 3.7473813905470037`*^9}, {3.747381619306817*^9, 
  3.747381640615485*^9}, {3.7473817238187733`*^9, 3.747381735174898*^9}, {
  3.747466310084756*^9, 
  3.747466313929084*^9}},ExpressionUUID->"16a6ddd9-4cbb-4134-bef0-\
062654c361d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "RTinterface", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7474818438117733`*^9, 3.7474818465276527`*^9}, {
  3.7474821838048983`*^9, 3.7474821882688828`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"e3234ac0-ca14-4c21-8e1e-b3501e4ae96b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RTinterface", "[", "i_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"RT", "[", 
    RowBox[{
     RowBox[{"LList", "[", 
      RowBox[{"[", 
       RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
     RowBox[{"LList", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7473817372459183`*^9, 3.747381758513673*^9}, {
   3.7474659267482233`*^9, 3.747465964437801*^9}, {3.747466037686325*^9, 
   3.747466046790423*^9}, 3.747466305710747*^9, 3.747481713258696*^9, {
   3.7474818416316957`*^9, 3.747481842332635*^9}, {3.747482190285638*^9, 
   3.747482222890893*^9}, 3.7474831009258547`*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"1f8fdc26-8da9-4ae5-b24c-d3e9c6e03c2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pvec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"p", ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", ".3", ",", ".0025"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rtest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RTinterface", "[", 
         RowBox[{"i", ",", "#"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "model"}], "-", "1"}]}], "}"}]}], "]"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], "/@", "pvec"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.747382034607136*^9, 3.747382055830804*^9}, {
   3.747382195616871*^9, 3.747382210020954*^9}, {3.747383521922*^9, 
   3.747383570330681*^9}, 3.747386417211594*^9, {3.747466053314994*^9, 
   3.747466083298813*^9}, {3.74746617196754*^9, 3.7474661928970127`*^9}, 
   3.747466240458473*^9, {3.747466327247697*^9, 3.747466328020102*^9}, {
   3.747466466501771*^9, 3.7474665109651957`*^9}, {3.747466637146226*^9, 
   3.747466686917104*^9}, {3.747466942217457*^9, 3.747466965493724*^9}, {
   3.747482092921668*^9, 3.747482103573843*^9}, {3.7474822290044107`*^9, 
   3.747482290337598*^9}},ExpressionUUID->"e61ec28e-5d44-4f6c-96c6-\
7129321a4902"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RTinterface", "[", 
       RowBox[{"i", ",", "#"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"Length", "@", "model"}], "-", "1"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "&"}], "/@", 
  RowBox[{"pvec", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.747482297130068*^9, 3.747482299056573*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"a5db76f3-c577-4cef-abfa-992972f550df"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    TemplateBox[{"18"},
                    "OutputSizeLimit`Skeleton"], "\[VeryThinSpace]", "-", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], ")"}], " ", 
                    TemplateBox[{"5"},
                    "OutputSizeLimit`Skeleton"], " ", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], 
                    RowBox[{
                    SqrtBox[
                    RowBox[{
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "+", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}]], " ", 
                    SqrtBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]]}]]}], "+", 
                    TemplateBox[{"4"},
                    "OutputSizeLimit`Skeleton"]}], ")"}]}], 
                 RowBox[{
                  RowBox[{"-", "1.`"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], 
                    RowBox[{
                    SqrtBox[
                    RowBox[{
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "+", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}]], " ", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}]]}], "+", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "+", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "-", 
                    FractionBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    TemplateBox[{"5"},
                    "OutputSizeLimit`Skeleton"], "+", 
                    FractionBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]]}], ")"}], 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"]}]], "+", 
                FractionBox[
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"]]}], ",", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"]}], "}"}], ",", 
             RowBox[{"{", 
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"], "}"}]}], "}"}], ",", 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{65., {3., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 45, 26796555998562420339, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 45, 26796555998562420339, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{65., {1., 11.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 45, 26796555998562420339, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{78., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[26796555998562420339 === $SessionID, 
   Out[45], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{3.747482280024672*^9, 3.747482312652038*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"5568286b-fd06-4b0f-8491-4f9b771db407"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pvec", ",", 
      RowBox[{"-", 
       RowBox[{"Re", "@", 
        RowBox[{"rtest", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], 
    "\[Transpose]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0.3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", ".5"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.747381808765369*^9, 3.74738187000696*^9}, {
   3.74738195681728*^9, 3.747382118670808*^9}, {3.747382179367319*^9, 
   3.7473822232421923`*^9}, {3.747383550457945*^9, 3.747383551705809*^9}, {
   3.747386448335723*^9, 3.7473864637058907`*^9}, {3.747387407126541*^9, 
   3.747387433630612*^9}, {3.747387776844301*^9, 3.747387792140065*^9}, {
   3.7473882266971607`*^9, 3.747388245456669*^9}, 3.7474660995242767`*^9, {
   3.747466984808807*^9, 3.747467004167901*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"8fa2200d-963f-4aa4-84b6-40a5d51ecbf0"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJw1kwlQU2cURrGOqIi4INRRi8KoxQ1cKg4W+bCUAqOIgIpQRixS0KqVGkBE
JdgANS4kgMgqIIGEnbAEQlgMAUIkLElcsHaqKApu4wKiKI7UpNd/5k0meXn3
3u+c+8wDjnj++pWent7xz5f288vxVbIGgyMYODGnzPl+ZCCq+RYL9zC/fA9F
WMv6SZsvMiA2i33mIY4CR3rKe1btl/sxeLQs01M1yEB6mvawYVyRV8lcGkr/
j4f9lCdV5oxQPPfQ/pKAc1/rzanrCqXnL0J5cqqxq00YDHp5IZsMUqBwtAq7
WRJG9dLwyHhvTMCacCzz48hGLDPBidg9e6QlnOpnAdl/RyYGHkPe56d7eTlQ
Nq7lOxhHUL8r4JkYGOqrIrBOd3h4PeNIzZP049Q/D4xXNk7DjEi0jFh+7pCP
GRC8Xv7zCZpHgOjHIYlp20/CU9ewAOOS8WyXHadovkJsfGdu+0NQFO5HagsW
YcNOQ8uEOCbNW4KKwHuMHN9o/KEdL6QUnIzBG1bvo2n+MpiXult9yDqN/20I
cefuBJ+pW/+kPEIMz1yTtE+PBRddgwrYz/g2ZmYDi/JVIKJ9p8NcZgy03fw4
lXAOKHdjucZS3irYZLkW+M6Pgy5ObxXEaz3aBW/iKH81/L09c0Nv/oWF2nHM
RPjw6Z8aZeMZ4iGC6DbLSFzKRnCQ9tTgDdfDySn/LPGpBYeTymXmnYO22pyy
WkwWO8sZxeeJlxjhitpAa8kFvNWWGxFjfOOEDKkqnvjVYZe038PmJQf2uoIS
xIznzVOd5RJPCfSFG/0nWyRAN15sPX7xP5Lt2phAfBsQMfR8JNsvEV2d2tMA
dXzsiLFeEvFuhHHzvfJyQRJMdAM2Ydqiyw2nvC4S/ybU75m0mT0xGbpyflcR
IXcY/bc2mXxIsXaKld2ZkEuURwqk9Bklr0ohP1LUj99cPPtlCuWTInjh0Mvp
olTy1Ywfe7yKU5hplLcZu11M9l/dlk7+mtF/efr8SxYZlF8Gt8Gi4lVjGeRT
hsHF4xPTbmcSDxmK7y6weC65TH5bEB/bv9wuN4v4tKDfxT8qOz6bfLfAQ39o
wNQhh3i1Yt3tyfOi63PIfyuMYo4KUm2vEL9WeHnML/tdcoX2oQ0P2O4rZ9nn
Es825E7gz+S25tJ+tEGoCd360Y1HfOVYZzjxcfAdHu2LHMlcwdyBA3nEWw5T
uaHPuY95tD/tODzWyzqcmE/82+GkHnvFW8GnfWqHVYr+JWcFn3wowG1SLGPs
F5APBXYcatjiaFhAPhQotuWX36oqIB8KrOePum3zLyQf1yAyS03rMioiH9dQ
7S2qj5QVkY9r8Cni3IqKLCYfHRgwmb1df0MJuDofHVjpE7hk82gJ+egAM6PW
ZV9TKflQQlLXaZDPLiMfSowxhhMcfcvJhxKxCmehw1wh+eiEtWd7uFeckHx0
4rsHNwpOvxOSj078dvxg3NuDFeSjC3/ees+4319BProgWtF0Ity/knx0Id0i
/sGLu5Xkoxs+Hezr7IAq8tEN9vcjSy88rSIf3chYvdf1p2PV5KMH8uQDrtOm
ishHD3jr+4ztckTkowc9D3sHHTfVkA8VKjflGmX01VAeFbzMMgcUZ2vJjwpb
fPO9guzElE8F90/LSxe9FZMvFTZY7nZpFNdRXhXehdxp+yZWQv5UUPKZu5z8
6im/Gr5PRm390UA+1fho+l4lt24kHmqIC20ks6ybyK8aZzS7MhfgKvFRw+Ro
UuP0NVLyrUaTe3eQd5eUeGlQ9rQvZjysmfxr8Ey0+MKrlTLip8ELweNC1hsZ
vZ8aBLEemuf2tBBPDVZxLWTDza20HxociOsrX6RqI77XseBQ0NBqvXbal+tY
Ynr+0TxfBf4Do5yjyQ==
      "]]}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.3}, {0, 0.5}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.747381825225676*^9, 3.747381872232442*^9}, {
   3.7473819594513483`*^9, 3.7473820112435417`*^9}, {3.747382076897105*^9, 
   3.747382118946425*^9}, {3.747382179820833*^9, 3.7473822235373373`*^9}, {
   3.747383527910389*^9, 3.747383538117757*^9}, 3.747383576157423*^9, 
   3.7473864056208677`*^9, {3.747386448764657*^9, 3.7473864639613523`*^9}, 
   3.74738736115628*^9, 3.7473874340666437`*^9, {3.747387777081987*^9, 
   3.747387792381946*^9}, {3.747388212111307*^9, 3.747388245702656*^9}, 
   3.7473892027932253`*^9, {3.747466076363882*^9, 3.747466099726143*^9}, 
   3.7474661910998774`*^9, 3.747466331748893*^9, {3.74746698247471*^9, 
   3.7474670043997383`*^9}, 3.747467174683208*^9, 3.7474673567649307`*^9, 
   3.747467488042398*^9, 3.747467567863969*^9, 3.7474766057882233`*^9, 
   3.7474819113702393`*^9, {3.747482100160346*^9, 3.7474821126921062`*^9}},
 CellLabel->"Out[38]=",ExpressionUUID->"484da902-6ac1-4ec0-b0c8-91fa3a2cfd66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pvec", ",", 
      RowBox[{"Im", "@", 
       RowBox[{"rtest", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}]}], "}"}], 
    "\[Transpose]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0.3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.001", ",", 
        RowBox[{"-", ".008"}]}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.74738825217521*^9, 3.7473885658882*^9}, {
  3.747389207988605*^9, 3.747389209129867*^9}, {3.7474670152134533`*^9, 
  3.747467054919282*^9}, {3.7474820417464447`*^9, 3.7474820614550962`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"b42175d2-f9ed-4e1b-8a66-726fee5c8004"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJw9kwtQVHUUxlFLkoZSMZnGByGjKREam67aygcjeu/e6wPIiUwMHwQZkmAg
BaPjMx6aCCrMWqAGCqIoyGuVx5/X7rLAsjwkZHwE2KhAPhChsMTY5dzOzJ2d
/917z/m+73eu/ZYd3l+NtbCwCBq5TL9SZTktN1p7cixqymWuM9IfEfE3x/j+
fw5DYdCNpJVeHFPPPNTrpd6DQG3XIYO39P9B7Mywqni6jmOnVKaKRUFE3Mc5
PtLzR5Hbfk775gaO/ellupOAnWp/n3F+0vsn8J1seXnSVo5ZtaWFLLNKxuG/
m1o0X0v9VDj948qNx77l2Dzf+MqBub9AKH1hNxgm9U9F+rhbvw1GcSx95O22
tDNwklfKEg9I887iWETlXd1hjsnMlYZJmvXhySek+elI4RNiLVI5VjUwd2TC
OST99frZsZmSngxMsm+XpVzlmLd5YCbiuOiLxlJJ3wV47k7brNJzrDPS1DAL
J/nw1KFWSe8lPLi9K/lJF8dCTfJCsnFKkRsc+VTSfxl8Yv8HqmGOjdLIQae+
q1qw5slPDr60uzvx6HSe8eYBubhlUVC32Yknf7m4onBMrFbwzDTNN/4qjlu6
/Z6/mie/eRjs5iZ85Mczs522PMyZlusqD+XJfz72yOP3aw7wzM4kZ2YBXiQ0
Z7Yn8ZRHAQy/OnqHZvEsMMBUhTAujXsQW8ZTPkVQuHicfK+FZ6ZuUy4XYZG8
cIXLQ57yUqP/w10/F7/k2aCp3YAajvKBHrWNkvK7Bm1vrGyOo5K5mhteh3tK
k+0rNyXleR124Z+1un6uZGZ5h4pxb2LAJx07lJRvCbqyx5y9E61khnpTlWCf
TUP7gjNKyrsUmpn357Wolewds8AyxFjtWFzapKT8y1Dlprd40KNk5na+DAuO
yCq51wTiUQ5Vc86j1hkC+SnHN8+HJkXLBeJTjvSOZZq1XgL5K4flwm1HHIIE
4lUBn8x09vygQH4rUKDJDspPFYhfBfZ2np7vrRbIfyVOeOZNLWkSiGcl9m0J
CL7bI1AelWjuCU5IGycS3ypsyskt7p8mUj5VeOkQVZUvE4l3Ffy3tbfrBZHy
qsbWARuFzWaR+FcjYWfLreBdIuVXjfOXgv+5GifSPmigfRJZUpQiUp4aGGdF
p666ItJ+aNB6W+xVMJHy1UI9PtB6jUGkfdHCbf9jg2u7SHlr4dx1NEzbJdL+
6OA/MEFzvFuk/HWwFTpaxEci7ZMOw6VZWTEj51EeNbjvapvXNvL8KI8aRNjF
3SnqFIlHDR46vAhPviESjxpoZclJTRUi8dAj4/yww8VMkXjo4VL3bMnaGJF4
6DF5Vmh3rZ9IPGqxyLDQ/g1nkR0z86hFZHFuvK5P4lGLbvtIN9UFgXjUIUTv
cb7lU4F41EEnx6WYx0riUYcrX7y96vsIaX/r8cfsgOFXvdL3WI+Nr57NGa/k
iUc9nkasWNcRxxEPA4oTb9S4ZK8kHgZEbV+9WJe1gngYkOH/VpfPbg/i0QD3
5v7p4ozlxKMBjtt1N9fvcyceDYgMC0l1UYB4GNGwoTbwWu1S4mGExZC7ZWnc
QuJhhN9PvLN/qjPxaETYu1vX8z/YkZ9G7N00zal7fp/rKJ+R89SwwSrj+xj1
1wjLob57EbOXYJRXI8oKJ2dYV3hg1G8jFKp1ewuH16DB9ty1Tc2N+PdCX/Pq
LZ74D+PFW24=
      "]]}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.3}, {0.001, -0.008}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.747388270591373*^9, 3.747388326538343*^9}, {
   3.747388361820549*^9, 3.747388381064793*^9}, {3.747388412058178*^9, 
   3.7473885661782503`*^9}, {3.7473892028638687`*^9, 3.74738920951266*^9}, {
   3.7474670221986017`*^9, 3.7474670551788607`*^9}, 3.747467176743618*^9, 
   3.747467356841357*^9, 3.747467488118832*^9, 3.7474675681066713`*^9, 
   3.74747660582052*^9, 3.747481924300171*^9, {3.747482043404846*^9, 
   3.7474820619546223`*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"587682d2-29a5-47a7-811d-4d9ba0e5b242"]
}, Open  ]],

Cell["Calculate the response of the stack at a fixed p", "CodeText",
 CellChangeTimes->{{3.747381237286489*^9, 3.7473812397159977`*^9}, {
  3.747381366351882*^9, 3.7473813905470037`*^9}, {3.747381619306817*^9, 
  3.747381640615485*^9}, {3.7473817238187733`*^9, 3.747381735174898*^9}, {
  3.747466310084756*^9, 3.747466313929084*^9}, {3.74746718334233*^9, 
  3.747467192985094*^9}, {3.7474676548357897`*^9, 
  3.747467658112018*^9}},ExpressionUUID->"07f9fdab-7ca5-4010-9381-\
2a74586ebdad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "=", ".1"}], "}"}], ",", 
   RowBox[{
    RowBox[{"rd", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "model", "]"}], ",", "\[Omega]comp", ",", 
      "qList", ",", "dList", ",", 
      RowBox[{"RTinterface2", "[", "p", "]"}]}], "]"}], "//", "N"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.747467210393828*^9, 3.7474672832989073`*^9}, 
   3.747467457308922*^9, 3.747467631999715*^9, {3.747569741199834*^9, 
   3.747569770875165*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"43555aed-2e1d-4e03-b14f-8b29ded3a9ad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.3566874840753925`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.09429222492201557`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.14540479352572228`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.12587647244132427`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.1454047935257226`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.12587647244132438`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.29274338882510464`"}], "+", 
      RowBox[{"0.04935319767946104`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.747476606092136*^9, 3.74748193135093*^9, {3.74756975031339*^9, 
   3.747569771314623*^9}},
 CellLabel->
  "Out[241]=",ExpressionUUID->"75eb6512-1fbe-47fc-977e-c615f824a091"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Stovas and Ursin (2003) Well - log example", "Section",
 CellChangeTimes->{{3.7473773381799393`*^9, 3.747377347721385*^9}, {
  3.7473810680377293`*^9, 
  3.7473810735565042`*^9}},ExpressionUUID->"654570d1-8d91-4418-ab4e-\
b4d11f129a01"],

Cell[CellGroupData[{

Cell["Load and prepare the data", "Subsection",
 CellChangeTimes->{{3.74737706065038*^9, 3.747377091039295*^9}, {
  3.747377174388645*^9, 3.747377178494112*^9}, {3.7473773663300533`*^9, 
  3.7473773717451363`*^9}, {3.747377436124074*^9, 
  3.747377438141183*^9}},ExpressionUUID->"50684b04-fe81-4d99-94dc-\
700678d6ffc8"],

Cell["Null", "CodeText",ExpressionUUID->"a4e34306-0af0-43d3-9a2b-bef36f6ffdde"],

Cell["Null", "Input",ExpressionUUID->"3c24a24d-aeb1-4f04-9cd2-9cd2f0533659"],

Cell[CellGroupData[{

Cell["Null", "Input",ExpressionUUID->"7c3b643f-a89c-4a41-9340-0c358c793a41"],

Cell["Null", "Output",ExpressionUUID->"538c2494-e523-44c0-924c-cbb644e1b9e5"]
}, Open  ]],

Cell["Null", "CodeText",ExpressionUUID->"4a1fcc2e-eb14-4a0d-86b4-b18059e87e68"],

Cell["Null", "Input",ExpressionUUID->"0b6fae64-5505-45f7-89c0-1b7393dbb7d9"],

Cell["Null", "CodeText",ExpressionUUID->"d426c2fa-d51e-43a9-bdb4-89fbf35b9818"],

Cell["Null", "Input",ExpressionUUID->"825af256-9d94-410e-beb9-f128eed58e16"],

Cell["Null", "CodeText",ExpressionUUID->"ec1d9357-e36c-498d-b3dc-c2ca6eaa45e6"],

Cell["Null", "Input",ExpressionUUID->"38f126c4-49c6-4f4c-afee-d02ce9d0e033"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate the RT response", "Subsection",
 CellChangeTimes->{{3.74737706065038*^9, 3.747377091039295*^9}, {
  3.747377174388645*^9, 3.747377178494112*^9}, {3.7473773663300533`*^9, 
  3.7473773717451363`*^9}, {3.747377436124074*^9, 3.747377438141183*^9}, {
  3.747377649121665*^9, 3.7473776533625317`*^9}, {3.747389921477066*^9, 
  3.747389942007537*^9}},ExpressionUUID->"4abb4fc0-f13d-4a46-aa8d-\
fd1ee6dc1daf"],

Cell[CellGroupData[{

Cell[" for a fixed frequency/slowness pair", "Subsubsection",
 CellChangeTimes->{{3.7473899433922787`*^9, 
  3.7473899479567947`*^9}},ExpressionUUID->"45f35ade-da82-4584-b476-\
a3bbd9a612c8"],

Cell["Null", "CodeText",ExpressionUUID->"579f186d-792d-4052-be9c-9bc6e6f21d50"],

Cell["Null", "Input",ExpressionUUID->"68a1119f-449e-4bae-94ba-4415964f8a47"],

Cell["Null", "CodeText",ExpressionUUID->"88f532b6-3acc-4071-be63-c215502038f5"],

Cell["Null", "Input",ExpressionUUID->"dfd983aa-a615-4802-ab1a-74ea56395253"],

Cell["Null", "CodeText",ExpressionUUID->"9e28f81e-7638-4183-872c-d4b9288c5895"],

Cell["Null", "Input",ExpressionUUID->"66a981f1-5adb-45cc-bedd-5e468599f901"],

Cell["Null", "CodeText",ExpressionUUID->"822657b9-d32a-4350-b146-d093f7eff2d5"],

Cell[CellGroupData[{

Cell["Null", "Input",ExpressionUUID->"2b2b3696-c1f8-4262-96ed-fcc711c6cb7c"],

Cell["Null", "Output",ExpressionUUID->"aba3d9d8-b0fc-476e-84ab-6d774fc7df08"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[" for a range of frequency / wavenumbers", "Subsubsection",
 CellChangeTimes->{{3.7473899433922787`*^9, 3.7473899479567947`*^9}, {
  3.7473900524886923`*^9, 
  3.747390065330941*^9}},ExpressionUUID->"af7e3fe2-ecfe-457d-9c9c-\
2a6a539fb974"],

Cell["predefine arrays", "CodeText",
 CellChangeTimes->{{3.7473901559444923`*^9, 
  3.747390169656323*^9}},ExpressionUUID->"c596615c-554e-4060-887a-\
7a48cf8b6304"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "101", ",", ".5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", ".25", ",", ".00125"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kList", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"2", "Pi", " ", 
       RowBox[{"fList", "[", 
        RowBox[{"[", "fj", "]"}], "]"}], 
       RowBox[{"pList", "[", 
        RowBox[{"[", "pj", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"fj", ",", "1", ",", 
        RowBox[{"Length", "[", "fList", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pj", ",", "1", ",", 
        RowBox[{"Length", "[", "pList", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"output", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "fList", "]"}], ",", 
       RowBox[{"Length", "[", "pList", "]"}], ",", "2", ",", "2"}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.747390088797329*^9, 3.7473901506320467`*^9}, {
   3.747390575774085*^9, 3.747390610698172*^9}, {3.747390960591589*^9, 
   3.7473909626952*^9}, {3.747391106622665*^9, 3.747391124633696*^9}, {
   3.747391421361306*^9, 3.747391428017626*^9}, {3.7473917541777163`*^9, 
   3.7473917677518797`*^9}, {3.747394265240611*^9, 3.747394284766642*^9}, {
   3.7473964292841253`*^9, 3.7473964294382467`*^9}, {3.747396614841267*^9, 
   3.747396616651857*^9}, {3.747402214558084*^9, 3.747402226399575*^9}, {
   3.7474024244988203`*^9, 3.747402427832797*^9}, {3.747402627187251*^9, 
   3.747402634789793*^9}, {3.747403078333542*^9, 3.747403096005754*^9}, {
   3.747414799790394*^9, 3.74741481510332*^9}, 3.7474149886141653`*^9, {
   3.747415030620665*^9, 3.7474150503018303`*^9}, {3.747417008463871*^9, 
   3.747417024260826*^9}, {3.7474177695228233`*^9, 3.747417782849481*^9}, {
   3.747418060658661*^9, 3.747418078483203*^9}, 3.74741945890383*^9, {
   3.747419586495418*^9, 3.7474195918529882`*^9}, {3.747419990823823*^9, 
   3.747420003835018*^9}, {3.7474691887309227`*^9, 3.747469194786471*^9}, {
   3.747471724713607*^9, 3.747471733906837*^9}, {3.747472394056554*^9, 
   3.7474724372372913`*^9}, {3.747473861402933*^9, 3.747473875077958*^9}, {
   3.747474905801217*^9, 3.747474912130673*^9}, 3.74747508056806*^9, {
   3.747476533788001*^9, 3.747476535504698*^9}, 3.747476577623684*^9, 
   3.747477088901078*^9, 3.747477125908063*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"be723fc6-93c8-414c-975e-afbdb82fb127"],

Cell["loop over frequency/wavenumber", "CodeText",
 CellChangeTimes->{{3.7473901559444923`*^9, 3.747390198259634*^9}, {
  3.747471359811429*^9, 
  3.747471364888942*^9}},ExpressionUUID->"397235b2-ef71-43c8-baba-\
08aa9f2c910f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "fList", "]"}], "\[GreaterEqual]", 
     RowBox[{"Length", "[", "pList", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listLong", "=", "fList"}], ";", 
     RowBox[{"listShort", "=", "pList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"writeOut", "[", 
       RowBox[{"jS_", ",", "jL_", ",", "writeFrom_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"output", "[", 
        RowBox[{"[", 
         RowBox[{"jL", ",", "jS"}], "]"}], "]"}], "=", "writeFrom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pf", "[", 
       RowBox[{"jS_", ",", "jL_"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"pList", "[", 
         RowBox[{"[", "jS", "]"}], "]"}], ",", 
        RowBox[{"fList", "[", 
         RowBox[{"[", "jL", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listLong", "=", "pList"}], ";", 
     RowBox[{"listShort", "=", "fList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"writeOut", "[", 
       RowBox[{"jS_", ",", "jL_", ",", "writeFrom_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"output", "[", 
        RowBox[{"[", 
         RowBox[{"jS", ",", "jL"}], "]"}], "]"}], "=", "writeFrom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pf", "[", 
       RowBox[{"jS_", ",", "jL_"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"pList", "[", 
         RowBox[{"[", "jL", "]"}], "]"}], ",", 
        RowBox[{"fList", "[", 
         RowBox[{"[", "jS", "]"}], "]"}]}], "}"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7473902033744307`*^9, 3.747390349632296*^9}, {
   3.747390384163583*^9, 3.747390480532502*^9}, {3.7473905244216623`*^9, 
   3.747390525634223*^9}, {3.747390709421997*^9, 3.7473907112610683`*^9}, {
   3.747391012760269*^9, 3.747391012875765*^9}, {3.747391135968746*^9, 
   3.747391140962044*^9}, {3.747391260147698*^9, 3.7473913449125967`*^9}, {
   3.747391394817429*^9, 3.7473913956349382`*^9}, {3.74739153030597*^9, 
   3.747391555131609*^9}, {3.747391722344503*^9, 3.747391731586879*^9}, {
   3.7473942477250357`*^9, 3.747394257277479*^9}, {3.7473943353852787`*^9, 
   3.747394404353936*^9}, {3.747395474036394*^9, 3.747395524833782*^9}, {
   3.747395891036401*^9, 3.747395891385426*^9}, {3.747395966764223*^9, 
   3.7473959745446463`*^9}, {3.747396578668304*^9, 3.747396597418047*^9}, {
   3.747396658706184*^9, 3.747396659000778*^9}, {3.747397391848755*^9, 
   3.747397392813457*^9}, {3.7473998913343763`*^9, 3.747399895652075*^9}, {
   3.747400080995644*^9, 3.747400147097252*^9}, {3.7474003369259987`*^9, 
   3.747400407952282*^9}, {3.7474004383651037`*^9, 3.747400647585788*^9}, 
   3.747400681170877*^9, {3.747400776654929*^9, 3.7474007879539557`*^9}, {
   3.7474008379421186`*^9, 3.747400846669436*^9}, {3.7474008961198387`*^9, 
   3.747400901244816*^9}, {3.7474009460590477`*^9, 3.747401026120905*^9}, {
   3.747401081223762*^9, 3.74740112668215*^9}, 3.747401280073485*^9, {
   3.7474014286662292`*^9, 3.7474014306516*^9}, 3.7474024087202168`*^9, {
   3.7474025765946913`*^9, 3.747402588708708*^9}, {3.747403068001771*^9, 
   3.747403068398427*^9}, {3.747414877308096*^9, 3.747414962246346*^9}, {
   3.74741505523588*^9, 3.747415070119973*^9}, {3.747415258856804*^9, 
   3.747415267336335*^9}, {3.747416892543791*^9, 3.747416894569048*^9}, {
   3.747417810895164*^9, 3.747417885216387*^9}, {3.747417973870023*^9, 
   3.747417979640111*^9}, 3.747418801444216*^9, {3.747419021872449*^9, 
   3.7474191605032177`*^9}, 3.747419219516514*^9, 3.747419290257409*^9, {
   3.7474193444120502`*^9, 3.7474193618305073`*^9}, {3.7474193971346607`*^9, 
   3.747419446368544*^9}, 3.747419489701212*^9, 3.74741959749657*^9, {
   3.747419922912486*^9, 3.747419975291711*^9}, {3.7474200341767073`*^9, 
   3.747420051699609*^9}, 3.747420122730297*^9, {3.747464263371266*^9, 
   3.747464336758173*^9}, {3.747469009803527*^9, 3.74746916359832*^9}, {
   3.747469217542225*^9, 3.747469267734264*^9}, {3.7474693441067953`*^9, 
   3.747469454651286*^9}, {3.747470109507183*^9, 3.747470179758613*^9}, {
   3.747470297841748*^9, 3.747470352480288*^9}, {3.747470491975865*^9, 
   3.747470492641183*^9}, {3.747470526352611*^9, 3.747470527087099*^9}, {
   3.7474705990538073`*^9, 3.747470600187867*^9}, {3.74747074695373*^9, 
   3.747470779164765*^9}, {3.747470828103664*^9, 3.747470828837343*^9}, {
   3.747471037426485*^9, 3.747471038660789*^9}, {3.747471074702343*^9, 
   3.7474711413144417`*^9}, {3.7474712142370043`*^9, 3.747471215318514*^9}, {
   3.747471279399405*^9, 3.74747128004489*^9}, {3.74747156119162*^9, 
   3.747471686170088*^9}, {3.747471739843485*^9, 3.747471760095015*^9}, {
   3.747472109744903*^9, 3.7474721400498343`*^9}, {3.747472359529154*^9, 
   3.747472385364389*^9}, 3.74747260411977*^9, {3.7474728202452374`*^9, 
   3.747472874439253*^9}, {3.747473427292398*^9, 3.747473464583378*^9}, {
   3.7474735162448378`*^9, 3.747473689519911*^9}, {3.7474738176695967`*^9, 
   3.74747382201403*^9}, {3.747473876983663*^9, 3.7474739019691133`*^9}, {
   3.747474004900285*^9, 3.74747403507806*^9}, 3.74747406628459*^9, {
   3.747474138414668*^9, 3.747474143271222*^9}, {3.747474349998983*^9, 
   3.747474386421317*^9}, {3.747474438546207*^9, 3.7474745108162193`*^9}, {
   3.747474558335252*^9, 3.7474746541929913`*^9}, {3.747474778057231*^9, 
   3.747474960887295*^9}, {3.747475114100174*^9, 3.7474751187526827`*^9}, {
   3.7474753318051777`*^9, 3.747475366709848*^9}, {3.747475434466835*^9, 
   3.747475450354697*^9}, {3.747475681991663*^9, 3.747475703233609*^9}, {
   3.7474759242636623`*^9, 3.747475941073176*^9}, {3.747476329676227*^9, 
   3.747476354940586*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"929e6068-5b44-43df-b9ff-24393dcf9891"],

Cell[CellGroupData[{

Cell["Null", "Input",ExpressionUUID->"20f3f7bb-d3fa-48d9-b971-0955804dffed"],

Cell["Null", "PrintTemporary",ExpressionUUID->"fe32d834-ced3-446e-9fe5-4339acc9915e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Null", "Input",ExpressionUUID->"3b00984c-78d5-40dd-8848-49e49155c90c"],

Cell["Null", "Output",ExpressionUUID->"cf37a09d-c5a6-4aba-8937-90c1ec751ecf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Null", "Input",ExpressionUUID->"6c1383d0-10e4-4029-96d2-e61d04290394"],

Cell["Null", "Output",ExpressionUUID->"df54d0c2-2c4d-4b8b-8c0d-092b188b7c5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Null", "Input",ExpressionUUID->"150d8816-b9d1-4ba4-8af5-b5bb42d1e3e1"],

Cell["Null", "Output",ExpressionUUID->"e4326185-f9fa-45d2-80ba-e4c9c4a4640a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowSize->{1718, 1348},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 169, 3, 67, "Section",ExpressionUUID->"4252a514-f584-47d0-aff6-7b89297f0eb3"],
Cell[CellGroupData[{
Cell[616, 22, 200, 3, 53, "Subsection",ExpressionUUID->"7db7c486-ac47-4517-b555-2e9483f292a6"],
Cell[819, 27, 860, 12, 37, "CodeText",ExpressionUUID->"694d0844-6d58-4b0e-8566-d121be6088e7"],
Cell[1682, 41, 10803, 288, 539, "Input",ExpressionUUID->"db78b205-a416-4027-8661-9195665415d0"]
}, Closed]],
Cell[CellGroupData[{
Cell[12522, 334, 267, 4, 37, "Subsection",ExpressionUUID->"aa2026d7-da1a-430a-9a75-38fead6a5fd8"],
Cell[12792, 340, 257, 5, 37, "CodeText",ExpressionUUID->"7ddb0035-6cfb-483b-8421-770e6389f206"],
Cell[13052, 347, 13513, 350, 1968, "Input",ExpressionUUID->"63138713-80ac-408d-a227-16b9d4c14505"],
Cell[26568, 699, 11716, 305, 1469, "Input",ExpressionUUID->"e19a226e-593f-4959-a641-555f09bc95e1"],
Cell[38287, 1006, 882, 20, 28, "Input",ExpressionUUID->"46eb411f-d3bf-4190-a84a-642b73214ba8"]
}, Closed]],
Cell[CellGroupData[{
Cell[39206, 1031, 274, 4, 37, "Subsection",ExpressionUUID->"bf065e10-b1cf-4791-9a14-3674ad00f459"],
Cell[39483, 1037, 7984, 197, 409, "Input",ExpressionUUID->"ddbe2a2b-33ab-4868-ae3c-17030ae9fe75"],
Cell[47470, 1236, 7456, 195, 390, "Input",ExpressionUUID->"b17b506d-5a69-45d1-a8d1-10e9d1f14517"],
Cell[54929, 1433, 212, 3, 28, "Input",ExpressionUUID->"ba1d8ada-d434-4775-b72f-6e205d1c62e5"],
Cell[55144, 1438, 6086, 153, 219, "Input",ExpressionUUID->"e634895c-37b0-4e69-9eac-21794dc36da3"],
Cell[61233, 1593, 7967, 181, 264, "Input",ExpressionUUID->"d1b0567f-ffd6-4ec6-b5d3-fa7ac7bae802"]
}, Closed]],
Cell[CellGroupData[{
Cell[69237, 1779, 319, 5, 37, "Subsection",ExpressionUUID->"24e23425-c5be-4b69-8a20-615758d6bc01"],
Cell[69559, 1786, 2967, 61, 200, "Input",ExpressionUUID->"6efafe00-0bd2-4936-85d3-c4e30adbbf6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72563, 1852, 264, 4, 53, "Subsection",ExpressionUUID->"b9a0e559-e977-4bcb-84fe-98ea291bb321"],
Cell[72830, 1858, 1086, 24, 162, "Input",ExpressionUUID->"30278ee1-bdad-494f-9f36-cc8013096086"],
Cell[73919, 1884, 649, 15, 48, "Input",ExpressionUUID->"1aecccf8-5f85-4b1f-b1eb-625ef29d538c"],
Cell[74571, 1901, 680, 17, 48, "Input",ExpressionUUID->"898e37d1-7bf3-4bac-a58d-fb2477340795"],
Cell[75254, 1920, 261, 5, 28, "Input",ExpressionUUID->"c2d0bc3b-209a-48e9-b6da-a30cb59aeb98"],
Cell[75518, 1927, 423, 10, 28, "Input",ExpressionUUID->"7ef98c1f-0395-4684-a56f-cc3e59384db1"],
Cell[CellGroupData[{
Cell[75966, 1941, 2277, 48, 86, "Input",ExpressionUUID->"e5cf36f5-c503-4f30-a30a-72d9d477ab14"],
Cell[78246, 1991, 26678, 454, 228, "Output",ExpressionUUID->"a5a56912-54aa-4964-aef4-043638bde052"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104961, 2450, 2872, 62, 124, "Input",ExpressionUUID->"ea8c2e57-8741-47c2-bcae-0902e2194e90"],
Cell[107836, 2514, 4697, 74, 41, "Message",ExpressionUUID->"4fc07830-77ff-4f8d-9e9b-bbf2c049cf01"],
Cell[112536, 2590, 4389, 69, 41, "Message",ExpressionUUID->"48fd32d9-9899-4e51-9250-3d4e930ec346"],
Cell[116928, 2661, 464, 10, 23, "Message",ExpressionUUID->"22c6f01a-2966-4bd9-bf5a-c543ccba6652"],
Cell[117395, 2673, 1681, 28, 23, "Message",ExpressionUUID->"e5fe2e86-8a8e-488e-a0ee-ce23a00c9e90"],
Cell[119079, 2703, 1770, 28, 23, "Message",ExpressionUUID->"567e644a-4ab5-4e26-bd30-18c497286ce2"],
Cell[120852, 2733, 1772, 28, 23, "Message",ExpressionUUID->"eebf29f4-738c-4681-a980-99a41fdc8327"],
Cell[122627, 2763, 1596, 26, 23, "Message",ExpressionUUID->"739d3109-447e-4338-a7ff-6069d6bb1e59"],
Cell[124226, 2791, 468, 10, 21, "Message",ExpressionUUID->"e8fc4536-9172-452d-9a75-95d99d0a81fe"],
Cell[124697, 2803, 5076, 75, 75, "Message",ExpressionUUID->"10b1f0d7-b1fa-43f8-9c0b-dc54cbb3fbeb"],
Cell[129776, 2880, 473, 10, 21, "Message",ExpressionUUID->"e418bbf3-d712-4e76-a46e-a84d7fa51a9f"],
Cell[130252, 2892, 506, 11, 21, "Message",ExpressionUUID->"bdab3d4f-db1a-4198-9ef5-33d0e6c44eb4"],
Cell[130761, 2905, 503, 11, 21, "Message",ExpressionUUID->"a9ca861d-7e1c-4531-bc70-545801776ceb"],
Cell[131267, 2918, 1472, 23, 23, "Message",ExpressionUUID->"e9fdbf2f-cbf4-4abc-adb3-881e7bf32fb7"],
Cell[132742, 2943, 1519, 25, 23, "Message",ExpressionUUID->"74d94f44-ff25-4a07-9158-cebc613ad87f"],
Cell[134264, 2970, 1478, 23, 23, "Message",ExpressionUUID->"3ec8e77e-9371-464a-846b-40b938462ca6"],
Cell[135745, 2995, 471, 10, 21, "Message",ExpressionUUID->"c92923e2-665a-493c-be55-938c7d879b81"],
Cell[136219, 3007, 914, 16, 23, "Message",ExpressionUUID->"aa7346ec-01e6-4181-862c-229741035570"],
Cell[137136, 3025, 912, 16, 23, "Message",ExpressionUUID->"f486cb14-8947-4622-b58d-a39ddb5fc3a5"],
Cell[138051, 3043, 556, 8, 32, "Output",ExpressionUUID->"4697dccf-4810-412c-a5bf-5b8a1b45c340"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138644, 3056, 1238, 30, 86, "Input",ExpressionUUID->"69a12e91-0321-4da6-8c7c-f0a813b76087"],
Cell[139885, 3088, 385, 7, 32, "Output",ExpressionUUID->"39590e3c-ed6d-4120-8106-b99288941852"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140307, 3100, 1325, 33, 48, "Input",ExpressionUUID->"cb63265d-9771-4015-b0d2-2b6b28ca1a07"],
Cell[141635, 3135, 394, 7, 32, "Output",ExpressionUUID->"5661e5ec-3476-462d-9603-2ce5a658b31f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[142090, 3149, 325, 6, 67, "Section",ExpressionUUID->"a7709b23-ba22-4f44-8d10-6a9e0601c295"],
Cell[CellGroupData[{
Cell[142440, 3159, 176, 3, 53, "Subsection",ExpressionUUID->"722ba902-75ea-441d-9400-c7e60c355260"],
Cell[142619, 3164, 205, 3, 37, "CodeText",ExpressionUUID->"2c812491-40d7-4377-90b4-01e89ef4746f"],
Cell[142827, 3169, 2357, 57, 314, "Input",ExpressionUUID->"435dfc3c-988a-4c72-839c-2ff4eead17f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145221, 3231, 226, 4, 53, "Subsection",ExpressionUUID->"a9cfd93a-0e1d-4373-a7ac-b559a18f8d04"],
Cell[145450, 3237, 512, 11, 117, "CodeText",ExpressionUUID->"bb684405-7a58-47fc-bdf2-51d6d8edc0e3"],
Cell[145965, 3250, 1485, 41, 105, "Input",ExpressionUUID->"c7bf3000-b46d-468b-9324-5f271387d923"],
Cell[147453, 3293, 5992, 128, 200, "Input",ExpressionUUID->"b53c50af-18cf-4715-a27a-8a7a49c8b870"],
Cell[153448, 3423, 179, 3, 28, "Input",ExpressionUUID->"e0f8eff9-72f6-45cf-9b5a-fd7d96f32878"],
Cell[153630, 3428, 643, 14, 48, "Input",ExpressionUUID->"eded190d-6e7d-421d-badd-899fcd7f6c28"],
Cell[154276, 3444, 175, 3, 28, "Input",ExpressionUUID->"69b48a8e-3f6a-46b2-ad61-10aac0b5fe58"],
Cell[CellGroupData[{
Cell[154476, 3451, 385, 9, 28, "Input",ExpressionUUID->"dbeb9f6a-7f91-4218-a592-75baea961db1"],
Cell[154864, 3462, 181, 2, 32, "Output",ExpressionUUID->"d63a0628-85f2-430f-a389-7bfc574dc25e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[155094, 3470, 456, 7, 53, "Subsection",ExpressionUUID->"e796478a-6d6e-4604-902d-8413ef35dd10"],
Cell[155553, 3479, 680, 15, 28, "Input",ExpressionUUID->"08cfc3f2-bfe0-4b4b-8c99-5916ab9ccad1"],
Cell[156236, 3496, 186, 4, 28, "Input",ExpressionUUID->"695ffed5-5637-4d3a-acff-24d6982e85b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156459, 3505, 403, 6, 53, "Subsection",ExpressionUUID->"20efa2a7-db76-4e32-936b-60ad8ce5ba25"],
Cell[156865, 3513, 463, 11, 117, "CodeText",ExpressionUUID->"2c5a3fc1-7173-400a-a9b1-f83a895feec4"],
Cell[157331, 3526, 278, 4, 37, "CodeText",ExpressionUUID->"de058845-3743-46b7-bfa2-9d118eec7154"],
Cell[157612, 3532, 2961, 76, 294, "Input",ExpressionUUID->"237e7007-6244-4f59-b397-35966def350c"],
Cell[160576, 3610, 329, 5, 37, "CodeText",ExpressionUUID->"80021aaa-5de0-4220-b44d-36c5cf660f70"],
Cell[160908, 3617, 736, 19, 48, "Input",ExpressionUUID->"79c9a561-9195-49df-99fd-22aa5a1f6d33"],
Cell[CellGroupData[{
Cell[161669, 3640, 259, 6, 28, "Input",ExpressionUUID->"c16176f2-ee9f-4650-a20f-9e30eddaab01"],
Cell[161931, 3648, 179, 3, 32, "Output",ExpressionUUID->"3cf668a3-8460-4180-a713-31da95bc5122"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162147, 3656, 244, 5, 28, "Input",ExpressionUUID->"59f4b858-3bf1-425a-9925-e6d29d75de0b"],
Cell[162394, 3663, 177, 3, 32, "Output",ExpressionUUID->"ba384fca-6673-45f3-a50d-d07f47da48f6"]
}, Open  ]],
Cell[162586, 3669, 357, 7, 37, "CodeText",ExpressionUUID->"d80aefa0-4c75-45c4-bada-5dc630f229e1"],
Cell[162946, 3678, 2160, 59, 257, "Input",ExpressionUUID->"b208fd7d-2555-4646-a874-5ae98de352b8"],
Cell[165109, 3739, 573, 16, 28, "Input",ExpressionUUID->"f24b6038-070e-431d-a4df-fdf4ec38e5e4"],
Cell[165685, 3757, 1213, 31, 86, "Input",ExpressionUUID->"187dfd08-daa2-45b8-9d2f-d3bab472130c"],
Cell[166901, 3790, 261, 5, 28, "Input",ExpressionUUID->"7b560cad-ba7e-498f-b29b-a806bdbec97d"],
Cell[167165, 3797, 214, 3, 28, "Input",ExpressionUUID->"3917d3e4-b8ba-4860-9c14-1628780e219f"],
Cell[167382, 3802, 153, 3, 28, "Input",ExpressionUUID->"45bed839-51cb-4841-8b26-636011a0f2fc"],
Cell[167538, 3807, 657, 17, 28, "Input",ExpressionUUID->"ad13ff55-dc09-4ba2-9bb3-2ede95e1c6dd"],
Cell[168198, 3826, 418, 8, 37, "CodeText",ExpressionUUID->"16a6ddd9-4cbb-4134-bef0-062654c361d1"],
Cell[168619, 3836, 288, 5, 28, "Input",ExpressionUUID->"e3234ac0-ca14-4c21-8e1e-b3501e4ae96b"],
Cell[168910, 3843, 757, 16, 48, "Input",ExpressionUUID->"1f8fdc26-8da9-4ae5-b24c-d3e9c6e03c2a"],
Cell[169670, 3861, 1367, 34, 48, "Input",ExpressionUUID->"e61ec28e-5d44-4f6c-96c6-7129321a4902"],
Cell[CellGroupData[{
Cell[171062, 3899, 637, 18, 28, "Input",ExpressionUUID->"a5db76f3-c577-4cef-abfa-992972f550df"],
Cell[171702, 3919, 11045, 287, 206, "Output",ExpressionUUID->"5568286b-fd06-4b0f-8491-4f9b771db407"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182784, 4211, 1150, 27, 28, "Input",ExpressionUUID->"8fa2200d-963f-4aa4-84b6-40a5d51ecbf0"],
Cell[183937, 4240, 3929, 74, 245, "Output",ExpressionUUID->"484da902-6ac1-4ec0-b0c8-91fa3a2cfd66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187903, 4319, 881, 23, 28, "Input",ExpressionUUID->"b42175d2-f9ed-4e1b-8a66-726fee5c8004"],
Cell[188787, 4344, 3327, 66, 218, "Output",ExpressionUUID->"587682d2-29a5-47a7-811d-4d9ba0e5b242"]
}, Open  ]],
Cell[192129, 4413, 489, 7, 37, "CodeText",ExpressionUUID->"07f9fdab-7ca5-4010-9381-2a74586ebdad"],
Cell[CellGroupData[{
Cell[192643, 4424, 615, 16, 28, "Input",ExpressionUUID->"43555aed-2e1d-4e03-b14f-8b29ded3a9ad"],
Cell[193261, 4442, 864, 21, 32, "Output",ExpressionUUID->"75eb6512-1fbe-47fc-977e-c615f824a091"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[194186, 4470, 242, 4, 53, "Section",ExpressionUUID->"654570d1-8d91-4418-ab4e-b4d11f129a01"],
Cell[CellGroupData[{
Cell[194453, 4478, 320, 5, 53, "Subsection",ExpressionUUID->"50684b04-fe81-4d99-94dc-700678d6ffc8"],
Cell[194776, 4485, 79, 0, 38, "CodeText",ExpressionUUID->"a4e34306-0af0-43d3-9a2b-bef36f6ffdde"],
Cell[194858, 4487, 76, 0, 30, "Input",ExpressionUUID->"3c24a24d-aeb1-4f04-9cd2-9cd2f0533659"],
Cell[CellGroupData[{
Cell[194959, 4491, 76, 0, 56, "Input",ExpressionUUID->"7c3b643f-a89c-4a41-9340-0c358c793a41"],
Cell[195038, 4493, 77, 0, 70, "Output",ExpressionUUID->"538c2494-e523-44c0-924c-cbb644e1b9e5"]
}, Open  ]],
Cell[195130, 4496, 79, 0, 38, "CodeText",ExpressionUUID->"4a1fcc2e-eb14-4a0d-86b4-b18059e87e68"],
Cell[195212, 4498, 76, 0, 482, "Input",ExpressionUUID->"0b6fae64-5505-45f7-89c0-1b7393dbb7d9"],
Cell[195291, 4500, 79, 0, 38, "CodeText",ExpressionUUID->"d426c2fa-d51e-43a9-bdb4-89fbf35b9818"],
Cell[195373, 4502, 76, 0, 218, "Input",ExpressionUUID->"825af256-9d94-410e-beb9-f128eed58e16"],
Cell[195452, 4504, 79, 0, 59, "CodeText",ExpressionUUID->"ec1d9357-e36c-498d-b3dc-c2ca6eaa45e6"],
Cell[195534, 4506, 76, 0, 178, "Input",ExpressionUUID->"38f126c4-49c6-4f4c-afee-d02ce9d0e033"]
}, Closed]],
Cell[CellGroupData[{
Cell[195647, 4511, 417, 6, 37, "Subsection",ExpressionUUID->"4abb4fc0-f13d-4a46-aa8d-fd1ee6dc1daf"],
Cell[CellGroupData[{
Cell[196089, 4521, 191, 3, 44, "Subsubsection",ExpressionUUID->"45f35ade-da82-4584-b476-a3bbd9a612c8"],
Cell[196283, 4526, 79, 0, 38, "CodeText",ExpressionUUID->"579f186d-792d-4052-be9c-9bc6e6f21d50"],
Cell[196365, 4528, 76, 0, 73, "Input",ExpressionUUID->"68a1119f-449e-4bae-94ba-4415964f8a47"],
Cell[196444, 4530, 79, 0, 38, "CodeText",ExpressionUUID->"88f532b6-3acc-4071-be63-c215502038f5"],
Cell[196526, 4532, 76, 0, 199, "Input",ExpressionUUID->"dfd983aa-a615-4802-ab1a-74ea56395253"],
Cell[196605, 4534, 79, 0, 38, "CodeText",ExpressionUUID->"9e28f81e-7638-4183-872c-d4b9288c5895"],
Cell[196687, 4536, 76, 0, 52, "Input",ExpressionUUID->"66a981f1-5adb-45cc-bedd-5e468599f901"],
Cell[196766, 4538, 79, 0, 38, "CodeText",ExpressionUUID->"822657b9-d32a-4350-b146-d093f7eff2d5"],
Cell[CellGroupData[{
Cell[196870, 4542, 76, 0, 52, "Input",ExpressionUUID->"2b2b3696-c1f8-4262-96ed-fcc711c6cb7c"],
Cell[196949, 4544, 77, 0, 56, "Output",ExpressionUUID->"aba3d9d8-b0fc-476e-84ab-6d774fc7df08"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[197075, 4550, 245, 4, 36, "Subsubsection",ExpressionUUID->"af7e3fe2-ecfe-457d-9c9c-2a6a539fb974"],
Cell[197323, 4556, 164, 3, 37, "CodeText",ExpressionUUID->"c596615c-554e-4060-887a-7a48cf8b6304"],
Cell[197490, 4561, 2818, 61, 105, "Input",ExpressionUUID->"be723fc6-93c8-414c-975e-afbdb82fb127"],
Cell[200311, 4624, 227, 4, 37, "CodeText",ExpressionUUID->"397235b2-ef71-43c8-baba-08aa9f2c910f"],
Cell[200541, 4630, 5911, 105, 181, "Input",ExpressionUUID->"929e6068-5b44-43df-b9ff-24393dcf9891"],
Cell[CellGroupData[{
Cell[206477, 4739, 76, 0, 28, "Input",ExpressionUUID->"20f3f7bb-d3fa-48d9-b971-0955804dffed"],
Cell[206556, 4741, 85, 0, 22, "PrintTemporary",ExpressionUUID->"fe32d834-ced3-446e-9fe5-4339acc9915e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206678, 4746, 76, 0, 28, "Input",ExpressionUUID->"3b00984c-78d5-40dd-8848-49e49155c90c"],
Cell[206757, 4748, 77, 0, 32, "Output",ExpressionUUID->"cf37a09d-c5a6-4aba-8937-90c1ec751ecf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206871, 4753, 76, 0, 28, "Input",ExpressionUUID->"6c1383d0-10e4-4029-96d2-e61d04290394"],
Cell[206950, 4755, 77, 0, 32, "Output",ExpressionUUID->"df54d0c2-2c4d-4b8b-8c0d-092b188b7c5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207064, 4760, 76, 0, 28, "Input",ExpressionUUID->"150d8816-b9d1-4ba4-8af5-b5bb42d1e3e1"],
Cell[207143, 4762, 77, 0, 32, "Output",ExpressionUUID->"e4326185-f9fa-45d2-80ba-e4c9c4a4640a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

